"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.AndroidUiautomator2Driver = void 0;

var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));

var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));

var _lodash = _interopRequireDefault(require("lodash"));

var _appiumBaseDriver = require("appium-base-driver");

var _uiautomator = _interopRequireDefault(require("./uiautomator2"));

var _appiumSupport = require("appium-support");

var _asyncbox = require("asyncbox");

var _bluebird = _interopRequireDefault(require("bluebird"));

var _logger = _interopRequireDefault(require("./logger"));

var _index = _interopRequireDefault(require("./commands/index"));

var _appiumAdb = require("appium-adb");

var _helpers = _interopRequireDefault(require("./helpers"));

var _appiumAndroidDriver = require("appium-android-driver");

var _desiredCaps = _interopRequireDefault(require("./desired-caps"));

var _portscanner = require("portscanner");

const helpers = Object.assign({}, _helpers.default, _appiumAndroidDriver.androidHelpers);
const SYSTEM_PORT_RANGE = [8200, 8299];
const DEVICE_PORT = 6790;
const NO_PROXY = [['GET', new RegExp('^/session/(?!.*/)')], ['GET', new RegExp('^/session/[^/]+/alert_[^/]+')], ['GET', new RegExp('^/session/[^/]+/alert/[^/]+')], ['GET', new RegExp('^/session/[^/]+/appium/[^/]+/current_activity')], ['GET', new RegExp('^/session/[^/]+/appium/[^/]+/current_package')], ['GET', new RegExp('^/session/[^/]+/appium/app/[^/]+')], ['GET', new RegExp('^/session/[^/]+/appium/device/[^/]+')], ['GET', new RegExp('^/session/[^/]+/appium/settings')], ['GET', new RegExp('^/session/[^/]+/context')], ['GET', new RegExp('^/session/[^/]+/contexts')], ['GET', new RegExp('^/session/[^/]+/element/[^/]+/attribute')], ['GET', new RegExp('^/session/[^/]+/element/[^/]+/displayed')], ['GET', new RegExp('^/session/[^/]+/element/[^/]+/enabled')], ['GET', new RegExp('^/session/[^/]+/element/[^/]+/location_in_view')], ['GET', new RegExp('^/session/[^/]+/element/[^/]+/name')], ['GET', new RegExp('^/session/[^/]+/element/[^/]+/screenshot')], ['GET', new RegExp('^/session/[^/]+/element/[^/]+/selected')], ['GET', new RegExp('^/session/[^/]+/ime/[^/]+')], ['GET', new RegExp('^/session/[^/]+/location')], ['GET', new RegExp('^/session/[^/]+/log/types')], ['GET', new RegExp('^/session/[^/]+/network_connection')], ['GET', new RegExp('^/session/[^/]+/screenshot')], ['GET', new RegExp('^/session/[^/]+/url')], ['POST', new RegExp('^/session/[^/]+/[^/]+_alert$')], ['POST', new RegExp('^/session/[^/]+/actions')], ['POST', new RegExp('^/session/[^/]+/alert/[^/]+')], ['POST', new RegExp('^/session/[^/]+/app/[^/]')], ['POST', new RegExp('^/session/[^/]+/appium/[^/]+/start_activity')], ['POST', new RegExp('^/session/[^/]+/appium/app/[^/]+')], ['POST', new RegExp('^/session/[^/]+/appium/compare_images')], ['POST', new RegExp('^/session/[^/]+/appium/device/(?!set_clipboard|get_clipboard)[^/]+')], ['POST', new RegExp('^/session/[^/]+/appium/element/[^/]+/replace_value')], ['POST', new RegExp('^/session/[^/]+/appium/element/[^/]+/value')], ['POST', new RegExp('^/session/[^/]+/appium/getPerformanceData')], ['POST', new RegExp('^/session/[^/]+/appium/performanceData/types')], ['POST', new RegExp('^/session/[^/]+/appium/settings')], ['POST', new RegExp('^/session/[^/]+/appium/start_recording_screen')], ['POST', new RegExp('^/session/[^/]+/appium/stop_recording_screen')], ['POST', new RegExp('^/session/[^/]+/context')], ['POST', new RegExp('^/session/[^/]+/element')], ['POST', new RegExp('^/session/[^/]+/ime/[^/]+')], ['POST', new RegExp('^/session/[^/]+/keys')], ['POST', new RegExp('^/session/[^/]+/location')], ['POST', new RegExp('^/session/[^/]+/log')], ['POST', new RegExp('^/session/[^/]+/network_connection')], ['POST', new RegExp('^/session/[^/]+/timeouts')], ['POST', new RegExp('^/session/[^/]+/touch/multi/perform')], ['POST', new RegExp('^/session/[^/]+/touch/perform')], ['POST', new RegExp('^/session/[^/]+/url')], ['POST', new RegExp('^/session/[^/]+/execute')], ['POST', new RegExp('^/session/[^/]+/execute_async')], ['GET', new RegExp('^/session/[^/]+/window/rect')], ['POST', new RegExp('^/session/[^/]+/execute/async')], ['POST', new RegExp('^/session/[^/]+/execute/sync')]];
const CHROME_NO_PROXY = [['GET', new RegExp('^/session/[^/]+/appium')], ['GET', new RegExp('^/session/[^/]+/context')], ['GET', new RegExp('^/session/[^/]+/orientation')], ['POST', new RegExp('^/session/[^/]+/appium')], ['POST', new RegExp('^/session/[^/]+/context')], ['POST', new RegExp('^/session/[^/]+/orientation')], ['POST', new RegExp('^/session/[^/]+/touch/multi/perform')], ['POST', new RegExp('^/session/[^/]+/touch/perform')]];
const APP_EXTENSION = '.apk';
const MEMOIZED_FUNCTIONS = ['getWindowSize', 'getStatusBarHeight', 'getDevicePixelRatio'];

class AndroidUiautomator2Driver extends _appiumBaseDriver.BaseDriver {
  constructor(opts = {}, shouldValidateCaps = true) {
    delete opts.shell;
    super(opts, shouldValidateCaps);
    this.locatorStrategies = ['xpath', 'id', 'class name', 'accessibility id', '-android uiautomator'];
    this.desiredCapConstraints = _desiredCaps.default;
    this.uiautomator2 = null;
    this.jwpProxyActive = false;
    this.defaultIME = null;
    this.jwpProxyAvoid = NO_PROXY;
    this.apkStrings = {};
    this.settings = new _appiumBaseDriver.DeviceSettings({
      ignoreUnimportantViews: false,
      allowInvisibleElements: false
    }, this.onSettingsUpdate.bind(this));
    this.chromedriver = null;
    this.sessionChromedrivers = {};

    for (var _i = 0; _i < MEMOIZED_FUNCTIONS.length; _i++) {
      const fn = MEMOIZED_FUNCTIONS[_i];
      this[fn] = _lodash.default.memoize(this[fn]);
    }
  }

  validateDesiredCaps(caps) {
    return super.validateDesiredCaps(caps) && _appiumAndroidDriver.androidHelpers.validateDesiredCaps(caps);
  }

  createSession(...args) {
    var _this = this,
        _superprop_callCreateSession = (..._args) => super.createSession(..._args);

    return (0, _asyncToGenerator2.default)(function* () {
      try {
        let _ref = yield _superprop_callCreateSession(...args),
            _ref2 = (0, _slicedToArray2.default)(_ref, 2),
            sessionId = _ref2[0],
            caps = _ref2[1];

        let serverDetails = {
          platform: 'LINUX',
          webStorageEnabled: false,
          takesScreenshot: true,
          javascriptEnabled: true,
          databaseEnabled: false,
          networkConnectionEnabled: true,
          locationContextEnabled: false,
          warnings: {},
          desired: _this.caps
        };
        _this.caps = Object.assign(serverDetails, _this.caps);
        _this.curContext = _this.defaultContextName();
        let defaultOpts = {
          fullReset: false,
          autoLaunch: true,
          adbPort: _appiumAdb.DEFAULT_ADB_PORT,
          androidInstallTimeout: 90000
        };

        _lodash.default.defaults(_this.opts, defaultOpts);

        if (_this.isChromeSession) {
          _logger.default.info("We're going to run a Chrome-based session");

          let _helpers$getChromePkg = helpers.getChromePkg(_this.opts.browserName),
              pkg = _helpers$getChromePkg.pkg,
              activity = _helpers$getChromePkg.activity;

          _this.opts.appPackage = _this.caps.appPackage = pkg;
          _this.opts.appActivity = _this.caps.appActivity = activity;

          _logger.default.info(`Chrome-type package and activity are ${pkg} and ${activity}`);
        }

        if (_this.opts.reboot) {
          _this.setAvdFromCapabilities(caps);
        }

        if (_this.opts.app) {
          _this.opts.app = yield _this.helpers.configureApp(_this.opts.app, APP_EXTENSION);
          yield _this.checkAppPresent();
        } else if (_this.appOnDevice) {
          _logger.default.info(`App file was not listed, instead we're going to run ` + `${_this.opts.appPackage} directly on the device`);

          yield _this.checkPackagePresent();
        }

        _this.opts.systemPort = _this.opts.systemPort || (yield (0, _portscanner.findAPortNotInUse)(SYSTEM_PORT_RANGE[0], SYSTEM_PORT_RANGE[1]));
        _this.opts.adbPort = _this.opts.adbPort || _appiumAdb.DEFAULT_ADB_PORT;
        yield _this.startUiAutomator2Session();
        yield _this.fillDeviceDetails();

        if (_this.opts.mjpegScreenshotUrl) {
          _logger.default.info(`Starting MJPEG stream reading URL: '${_this.opts.mjpegScreenshotUrl}'`);

          _this.mjpegStream = new _appiumSupport.mjpeg.MJpegStream(_this.opts.mjpegScreenshotUrl);
          yield _this.mjpegStream.start();
        }

        return [sessionId, _this.caps];
      } catch (e) {
        yield _this.deleteSession();
        throw e;
      }
    })();
  }

  fillDeviceDetails() {
    var _this2 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      _this2.caps.pixelRatio = yield _this2.getDevicePixelRatio();
      _this2.caps.statBarHeight = yield _this2.getStatusBarHeight();
      _this2.caps.viewportRect = yield _this2.getViewPortRect();
    })();
  }

  get driverData() {
    return {};
  }

  getSession() {
    var _this3 = this,
        _superprop_callGetSession = (..._args2) => super.getSession(..._args2);

    return (0, _asyncToGenerator2.default)(function* () {
      let sessionData = yield _superprop_callGetSession();

      _logger.default.debug("Getting session details from server to mix in");

      let uia2Data = yield _this3.uiautomator2.jwproxy.command('/', 'GET', {});
      return Object.assign({}, sessionData, uia2Data);
    })();
  }

  isEmulator() {
    return !!(this.opts.avd || /emulator/.test(this.opts.udid));
  }

  setAvdFromCapabilities(caps) {
    if (this.opts.avd) {
      _logger.default.info('avd name defined, ignoring device name and platform version');
    } else {
      if (!caps.deviceName) {
        _logger.default.errorAndThrow('avd or deviceName should be specified when reboot option is enables');
      }

      if (!caps.platformVersion) {
        _logger.default.errorAndThrow('avd or platformVersion should be specified when reboot option is enabled');
      }

      let avdDevice = caps.deviceName.replace(/[^a-zA-Z0-9_.]/g, "-");
      this.opts.avd = `${avdDevice}__${caps.platformVersion}`;
    }
  }

  startUiAutomator2Session() {
    var _this4 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      if (!_this4.opts.javaVersion) {
        _this4.opts.javaVersion = yield helpers.getJavaVersion();
      }

      let _ref3 = yield helpers.getDeviceInfoFromCaps(_this4.opts),
          udid = _ref3.udid,
          emPort = _ref3.emPort;

      _this4.opts.udid = udid;
      _this4.opts.emPort = emPort;
      _this4.adb = yield _appiumAndroidDriver.androidHelpers.createADB(_this4.opts);

      if ((yield _this4.adb.getApiLevel()) < 21) {
        _logger.default.errorAndThrow('UIAutomation2 is only supported since Android 5.0 (Lollipop). ' + 'You could still use other supported backends in order to automate older Android versions.');
      }

      let appInfo = yield helpers.getLaunchInfo(_this4.adb, _this4.opts);
      Object.assign(_this4.opts, appInfo);
      _this4.caps.deviceName = _this4.adb.curDeviceId;
      _this4.caps.deviceUDID = _this4.opts.udid;
      yield _this4.initUiAutomator2Server();
      _this4.defaultIME = yield helpers.initDevice(_this4.adb, _this4.opts);

      _logger.default.debug(`Forwarding UiAutomator2 Server port ${DEVICE_PORT} to ${_this4.opts.systemPort}`);

      yield _this4.adb.forwardPort(_this4.opts.systemPort, DEVICE_PORT);

      if (_this4.opts.autoLaunch) {
        yield _this4.initAUT();
      }

      if (!_this4.caps.appPackage && appInfo) {
        _this4.caps.appPackage = appInfo.appPackage;
      }

      yield _this4.uiautomator2.startSession(_this4.caps);
      yield _this4.addDeviceInfoToCaps();

      if (!_this4.opts.skipUnlock) {
        yield helpers.unlock(_this4, _this4.adb, _this4.caps);
      } else {
        _logger.default.debug(`'skipUnlock' capability set, so skipping device unlock`);
      }

      if (_this4.opts.autoLaunch) {
        yield _this4.ensureAppStarts();
      }

      if (_appiumSupport.util.hasValue(_this4.opts.orientation)) {
        _logger.default.debug(`Setting initial orientation to '${_this4.opts.orientation}'`);

        yield _this4.setOrientation(_this4.opts.orientation);
      }

      if (_this4.opts.autoWebview) {
        const viewName = _this4.defaultWebviewName();

        const timeout = _this4.opts.autoWebviewTimeout || 2000;

        _logger.default.info(`Setting auto webview to context '${viewName}' with timeout ${timeout}ms`);

        yield (0, _asyncbox.retryInterval)(timeout / 500, 500, _this4.setContext.bind(_this4), viewName);
      }

      if (_this4.isChromeSession) {
        yield _this4.startChromeSession(_this4);
      }

      _this4.jwpProxyActive = true;
    })();
  }

  addDeviceInfoToCaps() {
    var _this5 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      const _ref4 = yield _this5.mobileGetDeviceInfo(),
            apiVersion = _ref4.apiVersion,
            platformVersion = _ref4.platformVersion,
            manufacturer = _ref4.manufacturer,
            model = _ref4.model,
            realDisplaySize = _ref4.realDisplaySize,
            displayDensity = _ref4.displayDensity;

      _this5.caps.deviceApiLevel = parseInt(apiVersion, 10);
      _this5.caps.platformVersion = platformVersion;
      _this5.caps.deviceScreenSize = realDisplaySize;
      _this5.caps.deviceScreenDensity = displayDensity;
      _this5.caps.deviceModel = model;
      _this5.caps.deviceManufacturer = manufacturer;
    })();
  }

  initUiAutomator2Server() {
    var _this6 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      _this6.uiautomator2 = new _uiautomator.default({
        host: _this6.opts.remoteAdbHost || _this6.opts.host || 'localhost',
        systemPort: _this6.opts.systemPort,
        devicePort: DEVICE_PORT,
        adb: _this6.adb,
        apk: _this6.opts.app,
        tmpDir: _this6.opts.tmpDir,
        appPackage: _this6.opts.appPackage,
        appActivity: _this6.opts.appActivity,
        disableWindowAnimation: !!_this6.opts.disableWindowAnimation
      });
      _this6.proxyReqRes = _this6.uiautomator2.proxyReqRes.bind(_this6.uiautomator2);
      yield _this6.uiautomator2.killUiAutomatorOnDevice();
      yield _this6.uiautomator2.installServerApk(_this6.opts.uiautomator2ServerInstallTimeout);
    })();
  }

  initAUT() {
    var _this7 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      if (_this7.opts.otherApps) {
        let otherApps;

        try {
          otherApps = helpers.parseArray(_this7.opts.otherApps);
        } catch (e) {
          _logger.default.errorAndThrow(`Could not parse "otherApps" capability: ${e.message}`);
        }

        otherApps = yield _bluebird.default.all(otherApps.map(app => _this7.helpers.configureApp(app, APP_EXTENSION)));
        yield helpers.installOtherApks(otherApps, _this7.adb, _this7.opts);
      }

      if (!_this7.opts.app) {
        if (_this7.opts.fullReset) {
          _logger.default.errorAndThrow('Full reset requires an app capability, use fastReset if app is not provided');
        }

        _logger.default.debug('No app capability. Assuming it is already on the device');

        if (_this7.opts.fastReset) {
          yield helpers.resetApp(_this7.adb, _this7.opts);
        }
      }

      if (!_this7.opts.skipUninstall) {
        yield _this7.adb.uninstallApk(_this7.opts.appPackage);
      }

      if (!_this7.opts.noSign) {
        let signed = yield _this7.adb.checkApkCert(_this7.opts.app, _this7.opts.appPackage);

        if (!signed && _this7.opts.app) {
          yield _this7.adb.sign(_this7.opts.app, _this7.opts.appPackage);
        }
      }

      if (_this7.opts.app) {
        yield helpers.installApk(_this7.adb, _this7.opts);
      }
    })();
  }

  ensureAppStarts() {
    var _this8 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      let appWaitPackage = _this8.opts.appWaitPackage || _this8.opts.appPackage;
      let appWaitActivity = _this8.opts.appWaitActivity || _this8.opts.appActivity;

      _logger.default.info(`UiAutomator2 did not start the activity we were waiting for, ` + `'${appWaitPackage}/${appWaitActivity}'. Starting it ourselves`);

      if (_this8.caps.androidCoverage) {
        _logger.default.info(`androidCoverage is configured. ` + ` Starting instrumentation of '${_this8.caps.androidCoverage}'...`);

        yield _this8.adb.androidCoverage(_this8.caps.androidCoverage, appWaitPackage, appWaitActivity);
      } else {
        yield _this8.adb.startApp({
          pkg: _this8.opts.appPackage,
          activity: _this8.opts.appActivity,
          action: _this8.opts.intentAction,
          category: _this8.opts.intentCategory,
          flags: _this8.opts.intentFlags,
          waitPkg: _this8.opts.appWaitPackage,
          waitActivity: _this8.opts.appWaitActivity,
          optionalIntentArguments: _this8.opts.optionalIntentArguments,
          stopApp: !_this8.opts.dontStopAppOnReset,
          retry: true
        });
      }
    })();
  }

  deleteSession() {
    var _this9 = this,
        _superprop_callDeleteSession = (..._args3) => super.deleteSession(..._args3);

    return (0, _asyncToGenerator2.default)(function* () {
      _logger.default.debug('Deleting UiAutomator2 session');

      yield _appiumAndroidDriver.androidHelpers.removeAllSessionWebSocketHandlers(_this9.server, _this9.sessionId);

      if (_this9.uiautomator2) {
        try {
          yield _this9.stopChromedriverProxies();
        } catch (err) {
          _logger.default.warn(`Unable to stop ChromeDriver proxies: ${err.message}`);
        }

        if (_this9.jwpProxyActive) {
          try {
            yield _this9.uiautomator2.deleteSession();
          } catch (err) {
            _logger.default.warn(`Unable to proxy deleteSession to UiAutomator2: ${err.message}`);
          }
        }

        _this9.uiautomator2 = null;
      }

      _this9.jwpProxyActive = false;

      if (_this9.adb) {
        if (_this9.opts.unicodeKeyboard && _this9.opts.resetKeyboard && _this9.defaultIME) {
          _logger.default.debug(`Resetting IME to '${_this9.defaultIME}'`);

          try {
            yield _this9.adb.setIME(_this9.defaultIME);
          } catch (err) {
            _logger.default.warn(`Unable to reset IME: ${err.message}`);
          }
        }

        if (_this9.caps.androidCoverage) {
          _logger.default.info('Shutting down the adb process of instrumentation...');

          yield _this9.adb.endAndroidCoverage();

          if (_this9.caps.androidCoverageEndIntent) {
            _logger.default.info(`Sending intent broadcast '${_this9.caps.androidCoverageEndIntent}' at the end of instrumenting.`);

            yield _this9.adb.broadcast(_this9.caps.androidCoverageEndIntent);
          } else {
            _logger.default.warn('No androidCoverageEndIntent is configured in caps. Possibly you cannot get coverage file.');
          }
        }

        if (_this9.opts.appPackage) {
          try {
            yield _this9.adb.forceStop(_this9.opts.appPackage);
          } catch (err) {
            _logger.default.warn(`Unable to force stop app: ${err.message}`);
          }
        }

        if (_this9.opts.fullReset && !_this9.opts.skipUninstall && !_this9.appOnDevice) {
          _logger.default.debug(`Capability 'fullReset' set to 'true', Uninstalling '${_this9.opts.appPackage}'`);

          try {
            yield _this9.adb.uninstallApk(_this9.opts.appPackage);
          } catch (err) {
            _logger.default.warn(`Unable to uninstall app: ${err.message}`);
          }
        }

        yield _this9.adb.stopLogcat();

        if (_appiumSupport.util.hasValue(_this9.opts.systemPort)) {
          try {
            yield _this9.adb.removePortForward(_this9.opts.systemPort);
          } catch (error) {
            _logger.default.warn(`Unable to remove port forward '${error.message}'`);
          }
        }

        if (_this9.opts.reboot) {
          let avdName = _this9.opts.avd.replace('@', '');

          _logger.default.debug(`Closing emulator '${avdName}'`);

          try {
            yield _this9.adb.killEmulator(avdName);
          } catch (err) {
            _logger.default.warn(`Unable to close emulator: ${err.message}`);
          }
        }
      }

      if (_this9.mjpegStream) {
        _logger.default.info('Closing MJPEG stream');

        _this9.mjpegStream.stop();
      }

      yield _superprop_callDeleteSession();
    })();
  }

  checkAppPresent() {
    var _this10 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      _logger.default.debug('Checking whether app is actually present');

      if (!(yield _appiumSupport.fs.exists(_this10.opts.app))) {
        _logger.default.errorAndThrow(`Could not find app apk at '${_this10.opts.app}'`);
      }
    })();
  }

  onSettingsUpdate() {
    return (0, _asyncToGenerator2.default)(function* () {})();
  }

  wrapBootstrapDisconnect(wrapped) {
    var _this11 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      yield wrapped();
      yield _this11.adb.restart();
      yield _this11.adb.forwardPort(_this11.opts.systemPort, DEVICE_PORT);
    })();
  }

  proxyActive(sessionId) {
    super.proxyActive(sessionId);
    return true;
  }

  canProxy(sessionId) {
    super.canProxy(sessionId);
    return true;
  }

  getProxyAvoidList(sessionId) {
    super.getProxyAvoidList(sessionId);

    if (_appiumSupport.util.hasValue(this.chromedriver)) {
      this.jwpProxyAvoid = CHROME_NO_PROXY;
    } else {
      this.jwpProxyAvoid = NO_PROXY;
    }

    if (this.opts.nativeWebScreenshot) {
      this.jwpProxyAvoid = [...this.jwpProxyAvoid, ['GET', new RegExp('^/session/[^/]+/screenshot')]];
    }

    return this.jwpProxyAvoid;
  }

  get isChromeSession() {
    return helpers.isChromeBrowser(this.opts.browserName);
  }

}

exports.AndroidUiautomator2Driver = AndroidUiautomator2Driver;
var _iteratorNormalCompletion = true;
var _didIteratorError = false;
var _iteratorError = undefined;

try {
  for (var _iterator = _lodash.default.toPairs(_appiumAndroidDriver.androidCommands)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
    let _step$value = (0, _slicedToArray2.default)(_step.value, 2),
        cmd = _step$value[0],
        fn = _step$value[1];

    AndroidUiautomator2Driver.prototype[cmd] = fn;
  }
} catch (err) {
  _didIteratorError = true;
  _iteratorError = err;
} finally {
  try {
    if (!_iteratorNormalCompletion && _iterator.return != null) {
      _iterator.return();
    }
  } finally {
    if (_didIteratorError) {
      throw _iteratorError;
    }
  }
}

var _iteratorNormalCompletion2 = true;
var _didIteratorError2 = false;
var _iteratorError2 = undefined;

try {
  for (var _iterator2 = _lodash.default.toPairs(_index.default)[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
    let _step2$value = (0, _slicedToArray2.default)(_step2.value, 2),
        cmd = _step2$value[0],
        fn = _step2$value[1];

    AndroidUiautomator2Driver.prototype[cmd] = fn;
  }
} catch (err) {
  _didIteratorError2 = true;
  _iteratorError2 = err;
} finally {
  try {
    if (!_iteratorNormalCompletion2 && _iterator2.return != null) {
      _iterator2.return();
    }
  } finally {
    if (_didIteratorError2) {
      throw _iteratorError2;
    }
  }
}

var _default = AndroidUiautomator2Driver;
exports.default = _default;require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9kcml2ZXIuanMiXSwibmFtZXMiOlsiaGVscGVycyIsIk9iamVjdCIsImFzc2lnbiIsInVpYXV0b21hdG9yMkhlbHBlcnMiLCJhbmRyb2lkSGVscGVycyIsIlNZU1RFTV9QT1JUX1JBTkdFIiwiREVWSUNFX1BPUlQiLCJOT19QUk9YWSIsIlJlZ0V4cCIsIkNIUk9NRV9OT19QUk9YWSIsIkFQUF9FWFRFTlNJT04iLCJNRU1PSVpFRF9GVU5DVElPTlMiLCJBbmRyb2lkVWlhdXRvbWF0b3IyRHJpdmVyIiwiQmFzZURyaXZlciIsImNvbnN0cnVjdG9yIiwib3B0cyIsInNob3VsZFZhbGlkYXRlQ2FwcyIsInNoZWxsIiwibG9jYXRvclN0cmF0ZWdpZXMiLCJkZXNpcmVkQ2FwQ29uc3RyYWludHMiLCJ1aWF1dG9tYXRvcjIiLCJqd3BQcm94eUFjdGl2ZSIsImRlZmF1bHRJTUUiLCJqd3BQcm94eUF2b2lkIiwiYXBrU3RyaW5ncyIsInNldHRpbmdzIiwiRGV2aWNlU2V0dGluZ3MiLCJpZ25vcmVVbmltcG9ydGFudFZpZXdzIiwiYWxsb3dJbnZpc2libGVFbGVtZW50cyIsIm9uU2V0dGluZ3NVcGRhdGUiLCJiaW5kIiwiY2hyb21lZHJpdmVyIiwic2Vzc2lvbkNocm9tZWRyaXZlcnMiLCJmbiIsIl8iLCJtZW1vaXplIiwidmFsaWRhdGVEZXNpcmVkQ2FwcyIsImNhcHMiLCJjcmVhdGVTZXNzaW9uIiwiYXJncyIsInNlc3Npb25JZCIsInNlcnZlckRldGFpbHMiLCJwbGF0Zm9ybSIsIndlYlN0b3JhZ2VFbmFibGVkIiwidGFrZXNTY3JlZW5zaG90IiwiamF2YXNjcmlwdEVuYWJsZWQiLCJkYXRhYmFzZUVuYWJsZWQiLCJuZXR3b3JrQ29ubmVjdGlvbkVuYWJsZWQiLCJsb2NhdGlvbkNvbnRleHRFbmFibGVkIiwid2FybmluZ3MiLCJkZXNpcmVkIiwiY3VyQ29udGV4dCIsImRlZmF1bHRDb250ZXh0TmFtZSIsImRlZmF1bHRPcHRzIiwiZnVsbFJlc2V0IiwiYXV0b0xhdW5jaCIsImFkYlBvcnQiLCJERUZBVUxUX0FEQl9QT1JUIiwiYW5kcm9pZEluc3RhbGxUaW1lb3V0IiwiZGVmYXVsdHMiLCJpc0Nocm9tZVNlc3Npb24iLCJsb2dnZXIiLCJpbmZvIiwiZ2V0Q2hyb21lUGtnIiwiYnJvd3Nlck5hbWUiLCJwa2ciLCJhY3Rpdml0eSIsImFwcFBhY2thZ2UiLCJhcHBBY3Rpdml0eSIsInJlYm9vdCIsInNldEF2ZEZyb21DYXBhYmlsaXRpZXMiLCJhcHAiLCJjb25maWd1cmVBcHAiLCJjaGVja0FwcFByZXNlbnQiLCJhcHBPbkRldmljZSIsImNoZWNrUGFja2FnZVByZXNlbnQiLCJzeXN0ZW1Qb3J0Iiwic3RhcnRVaUF1dG9tYXRvcjJTZXNzaW9uIiwiZmlsbERldmljZURldGFpbHMiLCJtanBlZ1NjcmVlbnNob3RVcmwiLCJtanBlZ1N0cmVhbSIsIm1qcGVnIiwiTUpwZWdTdHJlYW0iLCJzdGFydCIsImUiLCJkZWxldGVTZXNzaW9uIiwicGl4ZWxSYXRpbyIsImdldERldmljZVBpeGVsUmF0aW8iLCJzdGF0QmFySGVpZ2h0IiwiZ2V0U3RhdHVzQmFySGVpZ2h0Iiwidmlld3BvcnRSZWN0IiwiZ2V0Vmlld1BvcnRSZWN0IiwiZHJpdmVyRGF0YSIsImdldFNlc3Npb24iLCJzZXNzaW9uRGF0YSIsImRlYnVnIiwidWlhMkRhdGEiLCJqd3Byb3h5IiwiY29tbWFuZCIsImlzRW11bGF0b3IiLCJhdmQiLCJ0ZXN0IiwidWRpZCIsImRldmljZU5hbWUiLCJlcnJvckFuZFRocm93IiwicGxhdGZvcm1WZXJzaW9uIiwiYXZkRGV2aWNlIiwicmVwbGFjZSIsImphdmFWZXJzaW9uIiwiZ2V0SmF2YVZlcnNpb24iLCJnZXREZXZpY2VJbmZvRnJvbUNhcHMiLCJlbVBvcnQiLCJhZGIiLCJjcmVhdGVBREIiLCJnZXRBcGlMZXZlbCIsImFwcEluZm8iLCJnZXRMYXVuY2hJbmZvIiwiY3VyRGV2aWNlSWQiLCJkZXZpY2VVRElEIiwiaW5pdFVpQXV0b21hdG9yMlNlcnZlciIsImluaXREZXZpY2UiLCJmb3J3YXJkUG9ydCIsImluaXRBVVQiLCJzdGFydFNlc3Npb24iLCJhZGREZXZpY2VJbmZvVG9DYXBzIiwic2tpcFVubG9jayIsInVubG9jayIsImVuc3VyZUFwcFN0YXJ0cyIsInV0aWwiLCJoYXNWYWx1ZSIsIm9yaWVudGF0aW9uIiwic2V0T3JpZW50YXRpb24iLCJhdXRvV2VidmlldyIsInZpZXdOYW1lIiwiZGVmYXVsdFdlYnZpZXdOYW1lIiwidGltZW91dCIsImF1dG9XZWJ2aWV3VGltZW91dCIsInNldENvbnRleHQiLCJzdGFydENocm9tZVNlc3Npb24iLCJtb2JpbGVHZXREZXZpY2VJbmZvIiwiYXBpVmVyc2lvbiIsIm1hbnVmYWN0dXJlciIsIm1vZGVsIiwicmVhbERpc3BsYXlTaXplIiwiZGlzcGxheURlbnNpdHkiLCJkZXZpY2VBcGlMZXZlbCIsInBhcnNlSW50IiwiZGV2aWNlU2NyZWVuU2l6ZSIsImRldmljZVNjcmVlbkRlbnNpdHkiLCJkZXZpY2VNb2RlbCIsImRldmljZU1hbnVmYWN0dXJlciIsIlVpQXV0b21hdG9yMlNlcnZlciIsImhvc3QiLCJyZW1vdGVBZGJIb3N0IiwiZGV2aWNlUG9ydCIsImFwayIsInRtcERpciIsImRpc2FibGVXaW5kb3dBbmltYXRpb24iLCJwcm94eVJlcVJlcyIsImtpbGxVaUF1dG9tYXRvck9uRGV2aWNlIiwiaW5zdGFsbFNlcnZlckFwayIsInVpYXV0b21hdG9yMlNlcnZlckluc3RhbGxUaW1lb3V0Iiwib3RoZXJBcHBzIiwicGFyc2VBcnJheSIsIm1lc3NhZ2UiLCJCIiwiYWxsIiwibWFwIiwiaW5zdGFsbE90aGVyQXBrcyIsImZhc3RSZXNldCIsInJlc2V0QXBwIiwic2tpcFVuaW5zdGFsbCIsInVuaW5zdGFsbEFwayIsIm5vU2lnbiIsInNpZ25lZCIsImNoZWNrQXBrQ2VydCIsInNpZ24iLCJpbnN0YWxsQXBrIiwiYXBwV2FpdFBhY2thZ2UiLCJhcHBXYWl0QWN0aXZpdHkiLCJhbmRyb2lkQ292ZXJhZ2UiLCJzdGFydEFwcCIsImFjdGlvbiIsImludGVudEFjdGlvbiIsImNhdGVnb3J5IiwiaW50ZW50Q2F0ZWdvcnkiLCJmbGFncyIsImludGVudEZsYWdzIiwid2FpdFBrZyIsIndhaXRBY3Rpdml0eSIsIm9wdGlvbmFsSW50ZW50QXJndW1lbnRzIiwic3RvcEFwcCIsImRvbnRTdG9wQXBwT25SZXNldCIsInJldHJ5IiwicmVtb3ZlQWxsU2Vzc2lvbldlYlNvY2tldEhhbmRsZXJzIiwic2VydmVyIiwic3RvcENocm9tZWRyaXZlclByb3hpZXMiLCJlcnIiLCJ3YXJuIiwidW5pY29kZUtleWJvYXJkIiwicmVzZXRLZXlib2FyZCIsInNldElNRSIsImVuZEFuZHJvaWRDb3ZlcmFnZSIsImFuZHJvaWRDb3ZlcmFnZUVuZEludGVudCIsImJyb2FkY2FzdCIsImZvcmNlU3RvcCIsInN0b3BMb2djYXQiLCJyZW1vdmVQb3J0Rm9yd2FyZCIsImVycm9yIiwiYXZkTmFtZSIsImtpbGxFbXVsYXRvciIsInN0b3AiLCJmcyIsImV4aXN0cyIsIndyYXBCb290c3RyYXBEaXNjb25uZWN0Iiwid3JhcHBlZCIsInJlc3RhcnQiLCJwcm94eUFjdGl2ZSIsImNhblByb3h5IiwiZ2V0UHJveHlBdm9pZExpc3QiLCJuYXRpdmVXZWJTY3JlZW5zaG90IiwiaXNDaHJvbWVCcm93c2VyIiwidG9QYWlycyIsImFuZHJvaWRDb21tYW5kcyIsImNtZCIsInByb3RvdHlwZSIsImNvbW1hbmRzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBR0EsTUFBTUEsT0FBTyxHQUFHQyxNQUFNLENBQUNDLE1BQVAsQ0FBYyxFQUFkLEVBQWtCQyxnQkFBbEIsRUFBdUNDLG1DQUF2QyxDQUFoQjtBQUlBLE1BQU1DLGlCQUFpQixHQUFHLENBQUMsSUFBRCxFQUFPLElBQVAsQ0FBMUI7QUFJQSxNQUFNQyxXQUFXLEdBQUcsSUFBcEI7QUFN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SXdGLG9CQUFLQyxRQUFMLENBQWMsS0FBS2xHLFlBQW5CLENBQUosRUFBc0M7QUFFcEMsV0FBS1IsYUFBTCxHQUFxQmQsZUFBckI7QUFDRCxLQUhELE1BR087QUFDTCxXQUFLYyxhQUFMLEdBQXFCaEIsUUFBckI7QUFDRDs7QUFDRCxRQUFJLEtBQUtRLElBQUwsQ0FBVTZNLG1CQUFkLEVBQW1DO0FBQ2pDLFdBQUtyTSxhQUFMLEdBQXFCLENBQUMsR0FBRyxLQUFLQSxhQUFULEVBQXdCLENBQUMsS0FBRCxFQUFRLElBQUlmLE1BQUosQ0FBVyw0QkFBWCxDQUFSLENBQXhCLENBQXJCO0FBQ0Q7O0FBRUQsV0FBTyxLQUFLZSxhQUFaO0FBQ0Q7O0FBRUQsTUFBSXFDLGVBQUosR0FBdUI7QUFDckIsV0FBTzVELE9BQU8sQ0FBQzZOLGVBQVIsQ0FBd0IsS0FBSzlNLElBQUwsQ0FBVWlELFdBQWxDLENBQVA7QUFDRDs7QUEzZGdEOzs7Ozs7OztBQStkbkQsdUJBQXNCOUIsZ0JBQUU0TCxPQUFGLENBQVVDLG9DQUFWLENBQXRCLDhIQUFrRDtBQUFBO0FBQUEsUUFBeENDLEdBQXdDO0FBQUEsUUFBbkMvTCxFQUFtQzs7QUFDaERyQixJQUFBQSx5QkFBeUIsQ0FBQ3FOLFNBQTFCLENBQW9DRCxHQUFwQyxJQUEyQy9MLEVBQTNDO0FBQ0Q7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUdELHdCQUFzQkMsZ0JBQUU0TCxPQUFGLENBQVVJLGNBQVYsQ0FBdEIsbUlBQTJDO0FBQUE7QUFBQSxRQUFqQ0YsR0FBaUM7QUFBQSxRQUE1Qi9MLEVBQTRCOztBQUN6Q3JCLElBQUFBLHlCQUF5QixDQUFDcU4sU0FBMUIsQ0FBb0NELEdBQXBDLElBQTJDL0wsRUFBM0M7QUFDRDs7Ozs7Ozs7Ozs7Ozs7OztlQUdjckIseUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IHsgQmFzZURyaXZlciwgRGV2aWNlU2V0dGluZ3MgfSBmcm9tICdhcHBpdW0tYmFzZS1kcml2ZXInO1xuaW1wb3J0IFVpQXV0b21hdG9yMlNlcnZlciBmcm9tICcuL3VpYXV0b21hdG9yMic7XG5pbXBvcnQgeyBmcywgdXRpbCwgbWpwZWcgfSBmcm9tICdhcHBpdW0tc3VwcG9ydCc7XG5pbXBvcnQgeyByZXRyeUludGVydmFsIH0gZnJvbSAnYXN5bmNib3gnO1xuaW1wb3J0IEIgZnJvbSAnYmx1ZWJpcmQnO1xuaW1wb3J0IGxvZ2dlciBmcm9tICcuL2xvZ2dlcic7XG5pbXBvcnQgY29tbWFuZHMgZnJvbSAnLi9jb21tYW5kcy9pbmRleCc7XG5pbXBvcnQgeyBERUZBVUxUX0FEQl9QT1JUIH0gZnJvbSAnYXBwaXVtLWFkYic7XG5pbXBvcnQgdWlhdXRvbWF0b3IySGVscGVycyBmcm9tICcuL2hlbHBlcnMnO1xuaW1wb3J0IHsgYW5kcm9pZEhlbHBlcnMsIGFuZHJvaWRDb21tYW5kcyB9IGZyb20gJ2FwcGl1bS1hbmRyb2lkLWRyaXZlcic7XG5pbXBvcnQgZGVzaXJlZENhcENvbnN0cmFpbnRzIGZyb20gJy4vZGVzaXJlZC1jYXBzJztcbmltcG9ydCB7IGZpbmRBUG9ydE5vdEluVXNlIH0gZnJvbSAncG9ydHNjYW5uZXInO1xuXG5cbmNvbnN0IGhlbHBlcnMgPSBPYmplY3QuYXNzaWduKHt9LCB1aWF1dG9tYXRvcjJIZWxwZXJzLCBhbmRyb2lkSGVscGVycyk7XG5cbi8vIFRoZSByYW5nZSBvZiBwb3J0cyB3ZSBjYW4gdXNlIG9uIHRoZSBzeXN0ZW0gZm9yIGNvbW11bmljYXRpbmcgdG8gdGhlXG4vLyBVaUF1dG9tYXRvcjIgSFRUUCBzZXJ2ZXIgb24gdGhlIGRldmljZVxuY29uc3QgU1lTVEVNX1BPUlRfUkFOR0UgPSBbODIwMCwgODI5OV07XG5cbi8vIFRoaXMgaXMgdGhlIHBvcnQgdGhhdCBVaUF1dG9tYXRvcjIgbGlzdGVucyB0byBvbiB0aGUgZGV2aWNlLiBXZSB3aWxsIGZvcndhcmRcbi8vIG9uZSBvZiB0aGUgcG9ydHMgYWJvdmUgb24gdGhlIHN5c3RlbSB0byB0aGlzIHBvcnQgb24gdGhlIGRldmljZS5cbmNvbnN0IERFVklDRV9QT1JUID0gNjc5MDtcblxuLy8gTk9fUFJPWFkgY29udGFpbnMgdGhlIHBhdGhzIHRoYXQgd2UgbmV2ZXIgd2FudCB0byBwcm94eSB0byBVaUF1dG9tYXRvcjIgc2VydmVyLlxuLy8gVE9ETzogIEFkZCB0aGUgbGlzdCBvZiBwYXRocyB0aGF0IHdlIG5ldmVyIHdhbnQgdG8gcHJveHkgdG8gVWlBdXRvbWF0b3IyIHNlcnZlci5cbi8vIFRPRE86IE5lZWQgdG8gc2VncmVnYXRlIHRoZSBwYXRocyBiZXR0ZXIgd2F5IHVzaW5nIHJlZ3VsYXIgZXhwcmVzc2lvbnMgd2hlcmV2ZXIgYXBwbGljYWJsZS5cbi8vIChOb3Qgc2VncmVnYXRpbmcgcmlnaHQgYXdheSBiZWNhdXNlIG1vcmUgcGF0aHMgdG8gYmUgYWRkZWQgaW4gdGhlIE5PX1BST1hZIGxpc3QpXG5jb25zdCBOT19QUk9YWSA9IFtcbiAgWydHRVQnLCBuZXcgUmVnRXhwKCdeL3Nlc3Npb24vKD8hLiovKScpXSxcbiAgWydHRVQnLCBuZXcgUmVnRXhwKCdeL3Nlc3Npb24vW14vXSsvYWxlcnRfW14vXSsnKV0sXG4gIFsnR0VUJywgbmV3IFJlZ0V4cCgnXi9zZXNzaW9uL1teL10rL2FsZXJ0L1teL10rJyldLFxuICBbJ0dFVCcsIG5ldyBSZWdFeHAoJ14vc2Vzc2lvbi9bXi9dKy9hcHBpdW0vW14vXSsvY3VycmVudF9hY3Rpdml0eScpXSxcbiAgWydHRVQnLCBuZXcgUmVnRXhwKCdeL3Nlc3Npb24vW14vXSsvYXBwaXVtL1teL10rL2N1cnJlbnRfcGFja2FnZScpXSxcbiAgWydHRVQnLCBuZXcgUmVnRXhwKCdeL3Nlc3Npb24vW14vXSsvYXBwaXVtL2FwcC9bXi9dKycpXSxcbiAgWydHRVQnLCBuZXcgUmVnRXhwKCdeL3Nlc3Npb24vW14vXSsvYXBwaXVtL2RldmljZS9bXi9dKycpXSxcbiAgWydHRVQnLCBuZXcgUmVnRXhwKCdeL3Nlc3Npb24vW14vXSsvYXBwaXVtL3NldHRpbmdzJyldLFxuICBbJ0dFVCcsIG5ldyBSZWdFeHAoJ14vc2Vzc2lvbi9bXi9dKy9jb250ZXh0JyldLFxuICBbJ0dFVCcsIG5ldyBSZWdFeHAoJ14vc2Vzc2lvbi9bXi9dKy9jb250ZXh0cycpXSxcbiAgWydHRVQnLCBuZXcgUmVnRXhwKCdeL3Nlc3Npb24vW14vXSsvZWxlbWVudC9bXi9dKy9hdHRyaWJ1dGUnKV0sXG4gIFsnR0VUJywgbmV3IFJlZ0V4cCgnXi9zZXNzaW9uL1teL10rL2VsZW1lbnQvW14vXSsvZGlzcGxheWVkJyldLFxuICBbJ0dFVCcsIG5ldyBSZWdFeHAoJ14vc2Vzc2lvbi9bXi9dKy9lbGVtZW50L1teL10rL2VuYWJsZWQnKV0sXG4gIFsnR0VUJywgbmV3IFJlZ0V4cCgnXi9zZXNzaW9uL1teL10rL2VsZW1lbnQvW14vXSsvbG9jYXRpb25faW5fdmlldycpXSxcbiAgWydHRVQnLCBuZXcgUmVnRXhwKCdeL3Nlc3Npb24vW14vXSsvZWxlbWVudC9bXi9dKy9uYW1lJyldLFxuICBbJ0dFVCcsIG5ldyBSZWdFeHAoJ14vc2Vzc2lvbi9bXi9dKy9lbGVtZW50L1teL10rL3NjcmVlbnNob3QnKV0sXG4gIFsnR0VUJywgbmV3IFJlZ0V4cCgnXi9zZXNzaW9uL1teL10rL2VsZW1lbnQvW14vXSsvc2VsZWN0ZWQnKV0sXG4gIFsnR0VUJywgbmV3IFJlZ0V4cCgnXi9zZXNzaW9uL1teL10rL2ltZS9bXi9dKycpXSxcbiAgWydHRVQnLCBuZXcgUmVnRXhwKCdeL3Nlc3Npb24vW14vXSsvbG9jYXRpb24nKV0sXG4gIFsnR0VUJywgbmV3IFJlZ0V4cCgnXi9zZXNzaW9uL1teL10rL2xvZy90eXBlcycpXSxcbiAgWydHRVQnLCBuZXcgUmVnRXhwKCdeL3Nlc3Npb24vW14vXSsvbmV0d29ya19jb25uZWN0aW9uJyldLFxuICBbJ0dFVCcsIG5ldyBSZWdFeHAoJ14vc2Vzc2lvbi9bXi9dKy9zY3JlZW5zaG90JyldLFxuICBbJ0dFVCcsIG5ldyBSZWdFeHAoJ14vc2Vzc2lvbi9bXi9dKy91cmwnKV0sXG4gIFsnUE9TVCcsIG5ldyBSZWdFeHAoJ14vc2Vzc2lvbi9bXi9dKy9bXi9dK19hbGVydCQnKV0sXG4gIFsnUE9TVCcsIG5ldyBSZWdFeHAoJ14vc2Vzc2lvbi9bXi9dKy9hY3Rpb25zJyldLFxuICBbJ1BPU1QnLCBuZXcgUmVnRXhwKCdeL3Nlc3Npb24vW14vXSsvYWxlcnQvW14vXSsnKV0sXG4gIFsnUE9TVCcsIG5ldyBSZWdFeHAoJ14vc2Vzc2lvbi9bXi9dKy9hcHAvW14vXScpXSxcbiAgWydQT1NUJywgbmV3IFJlZ0V4cCgnXi9zZXNzaW9uL1teL10rL2FwcGl1bS9bXi9dKy9zdGFydF9hY3Rpdml0eScpXSxcbiAgWydQT1NUJywgbmV3IFJlZ0V4cCgnXi9zZXNzaW9uL1teL10rL2FwcGl1bS9hcHAvW14vXSsnKV0sXG4gIFsnUE9TVCcsIG5ldyBSZWdFeHAoJ14vc2Vzc2lvbi9bXi9dKy9hcHBpdW0vY29tcGFyZV9pbWFnZXMnKV0sXG4gIFsnUE9TVCcsIG5ldyBSZWdFeHAoJ14vc2Vzc2lvbi9bXi9dKy9hcHBpdW0vZGV2aWNlLyg/IXNldF9jbGlwYm9hcmR8Z2V0X2NsaXBib2FyZClbXi9dKycpXSxcbiAgWydQT1NUJywgbmV3IFJlZ0V4cCgnXi9zZXNzaW9uL1teL10rL2FwcGl1bS9lbGVtZW50L1teL10rL3JlcGxhY2VfdmFsdWUnKV0sXG4gIFsnUE9TVCcsIG5ldyBSZWdFeHAoJ14vc2Vzc2lvbi9bXi9dKy9hcHBpdW0vZWxlbWVudC9bXi9dKy92YWx1ZScpXSxcbiAgWydQT1NUJywgbmV3IFJlZ0V4cCgnXi9zZXNzaW9uL1teL10rL2FwcGl1bS9nZXRQZXJmb3JtYW5jZURhdGEnKV0sXG4gIFsnUE9TVCcsIG5ldyBSZWdFeHAoJ14vc2Vzc2lvbi9bXi9dKy9hcHBpdW0vcGVyZm9ybWFuY2VEYXRhL3R5cGVzJyldLFxuICBbJ1BPU1QnLCBuZXcgUmVnRXhwKCdeL3Nlc3Npb24vW14vXSsvYXBwaXVtL3NldHRpbmdzJyldLFxuICBbJ1BPU1QnLCBuZXcgUmVnRXhwKCdeL3Nlc3Npb24vW14vXSsvYXBwaXVtL3N0YXJ0X3JlY29yZGluZ19zY3JlZW4nKV0sXG4gIFsnUE9TVCcsIG5ldyBSZWdFeHAoJ14vc2Vzc2lvbi9bXi9dKy9hcHBpdW0vc3RvcF9yZWNvcmRpbmdfc2NyZWVuJyldLFxuICBbJ1BPU1QnLCBuZXcgUmVnRXhwKCdeL3Nlc3Npb24vW14vXSsvY29udGV4dCcpXSxcbiAgWydQT1NUJywgbmV3IFJlZ0V4cCgnXi9zZXNzaW9uL1teL10rL2VsZW1lbnQnKV0sXG4gIFsnUE9TVCcsIG5ldyBSZWdFeHAoJ14vc2Vzc2lvbi9bXi9dKy9pbWUvW14vXSsnKV0sXG4gIFsnUE9TVCcsIG5ldyBSZWdFeHAoJ14vc2Vzc2lvbi9bXi9dKy9rZXlzJyldLFxuICBbJ1BPU1QnLCBuZXcgUmVnRXhwKCdeL3Nlc3Npb24vW14vXSsvbG9jYXRpb24nKV0sXG4gIFsnUE9TVCcsIG5ldyBSZWdFeHAoJ14vc2Vzc2lvbi9bXi9dKy9sb2cnKV0sXG4gIFsnUE9TVCcsIG5ldyBSZWdFeHAoJ14vc2Vzc2lvbi9bXi9dKy9uZXR3b3JrX2Nvbm5lY3Rpb24nKV0sXG4gIFsnUE9TVCcsIG5ldyBSZWdFeHAoJ14vc2Vzc2lvbi9bXi9dKy90aW1lb3V0cycpXSxcbiAgWydQT1NUJywgbmV3IFJlZ0V4cCgnXi9zZXNzaW9uL1teL10rL3RvdWNoL211bHRpL3BlcmZvcm0nKV0sXG4gIFsnUE9TVCcsIG5ldyBSZWdFeHAoJ14vc2Vzc2lvbi9bXi9dKy90b3VjaC9wZXJmb3JtJyldLFxuICBbJ1BPU1QnLCBuZXcgUmVnRXhwKCdeL3Nlc3Npb24vW14vXSsvdXJsJyldLFxuXG4gIC8vIE1KU09OV1AgY29tbWFuZHNcbiAgWydQT1NUJywgbmV3IFJlZ0V4cCgnXi9zZXNzaW9uL1teL10rL2V4ZWN1dGUnKV0sXG4gIFsnUE9TVCcsIG5ldyBSZWdFeHAoJ14vc2Vzc2lvbi9bXi9dKy9leGVjdXRlX2FzeW5jJyldLFxuICAvLyBXM0MgY29tbWFuZHNcbiAgWydHRVQnLCBuZXcgUmVnRXhwKCdeL3Nlc3Npb24vW14vXSsvd2luZG93L3JlY3QnKV0sXG4gIFsnUE9TVCcsIG5ldyBSZWdFeHAoJ14vc2Vzc2lvbi9bXi9dKy9leGVjdXRlL2FzeW5jJyldLFxuICBbJ1BPU1QnLCBuZXcgUmVnRXhwKCdeL3Nlc3Npb24vW14vXSsvZXhlY3V0ZS9zeW5jJyldLFxuXTtcblxuLy8gVGhpcyBpcyBhIHNldCBvZiBtZXRob2RzIGFuZCBwYXRocyB0aGF0IHdlIG5ldmVyIHdhbnQgdG8gcHJveHkgdG8gQ2hyb21lZHJpdmVyLlxuY29uc3QgQ0hST01FX05PX1BST1hZID0gW1xuICBbJ0dFVCcsIG5ldyBSZWdFeHAoJ14vc2Vzc2lvbi9bXi9dKy9hcHBpdW0nKV0sXG4gIFsnR0VUJywgbmV3IFJlZ0V4cCgnXi9zZXNzaW9uL1teL10rL2NvbnRleHQnKV0sXG4gIFsnR0VUJywgbmV3IFJlZ0V4cCgnXi9zZXNzaW9uL1teL10rL29yaWVudGF0aW9uJyldLFxuICBbJ1BPU1QnLCBuZXcgUmVnRXhwKCdeL3Nlc3Npb24vW14vXSsvYXBwaXVtJyldLFxuICBbJ1BPU1QnLCBuZXcgUmVnRXhwKCdeL3Nlc3Npb24vW14vXSsvY29udGV4dCcpXSxcbiAgWydQT1NUJywgbmV3IFJlZ0V4cCgnXi9zZXNzaW9uL1teL10rL29yaWVudGF0aW9uJyldLFxuICBbJ1BPU1QnLCBuZXcgUmVnRXhwKCdeL3Nlc3Npb24vW14vXSsvdG91Y2gvbXVsdGkvcGVyZm9ybScpXSxcbiAgWydQT1NUJywgbmV3IFJlZ0V4cCgnXi9zZXNzaW9uL1teL10rL3RvdWNoL3BlcmZvcm0nKV0sXG5dO1xuY29uc3QgQVBQX0VYVEVOU0lPTiA9ICcuYXBrJztcblxuY29uc3QgTUVNT0laRURfRlVOQ1RJT05TID0gW1xuICAnZ2V0V2luZG93U2l6ZScsXG4gICdnZXRTdGF0dXNCYXJIZWlnaHQnLFxuICAnZ2V0RGV2aWNlUGl4ZWxSYXRpbycsXG5dO1xuXG5jbGFzcyBBbmRyb2lkVWlhdXRvbWF0b3IyRHJpdmVyIGV4dGVuZHMgQmFzZURyaXZlciB7XG4gIGNvbnN0cnVjdG9yIChvcHRzID0ge30sIHNob3VsZFZhbGlkYXRlQ2FwcyA9IHRydWUpIHtcbiAgICAvLyBgc2hlbGxgIG92ZXJ3cml0ZXMgYWRiLnNoZWxsLCBzbyByZW1vdmVcbiAgICBkZWxldGUgb3B0cy5zaGVsbDtcblxuICAgIHN1cGVyKG9wdHMsIHNob3VsZFZhbGlkYXRlQ2Fwcyk7XG4gICAgdGhpcy5sb2NhdG9yU3RyYXRlZ2llcyA9IFtcbiAgICAgICd4cGF0aCcsXG4gICAgICAnaWQnLFxuICAgICAgJ2NsYXNzIG5hbWUnLFxuICAgICAgJ2FjY2Vzc2liaWxpdHkgaWQnLFxuICAgICAgJy1hbmRyb2lkIHVpYXV0b21hdG9yJ1xuICAgIF07XG4gICAgdGhpcy5kZXNpcmVkQ2FwQ29uc3RyYWludHMgPSBkZXNpcmVkQ2FwQ29uc3RyYWludHM7XG4gICAgdGhpcy51aWF1dG9tYXRvcjIgPSBudWxsO1xuICAgIHRoaXMuandwUHJveHlBY3RpdmUgPSBmYWxzZTtcbiAgICB0aGlzLmRlZmF1bHRJTUUgPSBudWxsO1xuICAgIHRoaXMuandwUHJveHlBdm9pZCA9IE5PX1BST1hZO1xuICAgIHRoaXMuYXBrU3RyaW5ncyA9IHt9OyAvLyBtYXAgb2YgbGFuZ3VhZ2UgLT4gc3RyaW5ncyBvYmpcblxuICAgIHRoaXMuc2V0dGluZ3MgPSBuZXcgRGV2aWNlU2V0dGluZ3Moe2lnbm9yZVVuaW1wb3J0YW50Vmlld3M6IGZhbHNlLCBhbGxvd0ludmlzaWJsZUVsZW1lbnRzOiBmYWxzZX0sXG4gICAgICAgIHRoaXMub25TZXR0aW5nc1VwZGF0ZS5iaW5kKHRoaXMpKTtcbiAgICAvLyBoYW5kbGUgd2VidmlldyBtZWNoYW5pY3MgZnJvbSBBbmRyb2lkRHJpdmVyXG4gICAgdGhpcy5jaHJvbWVkcml2ZXIgPSBudWxsO1xuICAgIHRoaXMuc2Vzc2lvbkNocm9tZWRyaXZlcnMgPSB7fTtcblxuICAgIC8vIG1lbW9pemUgZnVuY3Rpb25zIGhlcmUsIHNvIHRoYXQgdGhleSBhcmUgZG9uZSBvbiBhIHBlci1pbnN0YW5jZSBiYXNpc1xuICAgIGZvciAoY29uc3QgZm4gb2YgTUVNT0laRURfRlVOQ1RJT05TKSB7XG4gICAgICB0aGlzW2ZuXSA9IF8ubWVtb2l6ZSh0aGlzW2ZuXSk7XG4gICAgfVxuICB9XG5cbiAgdmFsaWRhdGVEZXNpcmVkQ2FwcyAoY2Fwcykge1xuICAgIHJldHVybiBzdXBlci52YWxpZGF0ZURlc2lyZWRDYXBzKGNhcHMpICYmIGFuZHJvaWRIZWxwZXJzLnZhbGlkYXRlRGVzaXJlZENhcHMoY2Fwcyk7XG4gIH1cblxuICBhc3luYyBjcmVhdGVTZXNzaW9uICguLi5hcmdzKSB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFRPRE8gaGFuZGxlIG90aGVyU2Vzc2lvbkRhdGEgZm9yIG11bHRpcGxlIHNlc3Npb25zXG4gICAgICBsZXQgW3Nlc3Npb25JZCwgY2Fwc10gPSBhd2FpdCBzdXBlci5jcmVhdGVTZXNzaW9uKC4uLmFyZ3MpO1xuXG4gICAgICBsZXQgc2VydmVyRGV0YWlscyA9IHtcbiAgICAgICAgcGxhdGZvcm06ICdMSU5VWCcsXG4gICAgICAgIHdlYlN0b3JhZ2VFbmFibGVkOiBmYWxzZSxcbiAgICAgICAgdGFrZXNTY3JlZW5zaG90OiB0cnVlLFxuICAgICAgICBqYXZhc2NyaXB0RW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgZGF0YWJhc2VFbmFibGVkOiBmYWxzZSxcbiAgICAgICAgbmV0d29ya0Nvbm5lY3Rpb25FbmFibGVkOiB0cnVlLFxuICAgICAgICBsb2NhdGlvbkNvbnRleHRFbmFibGVkOiBmYWxzZSxcbiAgICAgICAgd2FybmluZ3M6IHt9LFxuICAgICAgICBkZXNpcmVkOiB0aGlzLmNhcHMsXG4gICAgICB9O1xuXG4gICAgICB0aGlzLmNhcHMgPSBPYmplY3QuYXNzaWduKHNlcnZlckRldGFpbHMsIHRoaXMuY2Fwcyk7XG5cbiAgICAgIHRoaXMuY3VyQ29udGV4dCA9IHRoaXMuZGVmYXVsdENvbnRleHROYW1lKCk7XG5cbiAgICAgIGxldCBkZWZhdWx0T3B0cyA9IHtcbiAgICAgICAgZnVsbFJlc2V0OiBmYWxzZSxcbiAgICAgICAgYXV0b0xhdW5jaDogdHJ1ZSxcbiAgICAgICAgYWRiUG9ydDogREVGQVVMVF9BREJfUE9SVCxcbiAgICAgICAgYW5kcm9pZEluc3RhbGxUaW1lb3V0OiA5MDAwMFxuICAgICAgfTtcbiAgICAgIF8uZGVmYXVsdHModGhpcy5vcHRzLCBkZWZhdWx0T3B0cyk7XG5cbiAgICAgIGlmICh0aGlzLmlzQ2hyb21lU2Vzc2lvbikge1xuICAgICAgICBsb2dnZXIuaW5mbyhcIldlJ3JlIGdvaW5nIHRvIHJ1biBhIENocm9tZS1iYXNlZCBzZXNzaW9uXCIpO1xuICAgICAgICBsZXQge3BrZywgYWN0aXZpdHl9ID0gaGVscGVycy5nZXRDaHJvbWVQa2codGhpcy5vcHRzLmJyb3dzZXJOYW1lKTtcbiAgICAgICAgdGhpcy5vcHRzLmFwcFBhY2thZ2UgPSB0aGlzLmNhcHMuYXBwUGFja2FnZSA9IHBrZztcbiAgICAgICAgdGhpcy5vcHRzLmFwcEFjdGl2aXR5ID0gdGhpcy5jYXBzLmFwcEFjdGl2aXR5ID0gYWN0aXZpdHk7XG4gICAgICAgIGxvZ2dlci5pbmZvKGBDaHJvbWUtdHlwZSBwYWNrYWdlIGFuZCBhY3Rpdml0eSBhcmUgJHtwa2d9IGFuZCAke2FjdGl2aXR5fWApO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5vcHRzLnJlYm9vdCkge1xuICAgICAgICB0aGlzLnNldEF2ZEZyb21DYXBhYmlsaXRpZXMoY2Fwcyk7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLm9wdHMuYXBwKSB7XG4gICAgICAgIC8vIGZpbmQgYW5kIGNvcHksIG9yIGRvd25sb2FkIGFuZCB1bnppcCBhbiBhcHAgdXJsIG9yIHBhdGhcbiAgICAgICAgdGhpcy5vcHRzLmFwcCA9IGF3YWl0IHRoaXMuaGVscGVycy5jb25maWd1cmVBcHAodGhpcy5vcHRzLmFwcCwgQVBQX0VYVEVOU0lPTik7XG4gICAgICAgIGF3YWl0IHRoaXMuY2hlY2tBcHBQcmVzZW50KCk7XG4gICAgICB9IGVsc2UgaWYgKHRoaXMuYXBwT25EZXZpY2UpIHtcbiAgICAgICAgLy8gdGhlIGFwcCBpc24ndCBhbiBhY3R1YWwgYXBwIGZpbGUgYnV0IHJhdGhlciBzb21ldGhpbmcgd2Ugd2FudCB0b1xuICAgICAgICAvLyBhc3N1bWUgaXMgb24gdGhlIGRldmljZSBhbmQganVzdCBsYXVuY2ggdmlhIHRoZSBhcHBQYWNrYWdlXG4gICAgICAgIGxvZ2dlci5pbmZvKGBBcHAgZmlsZSB3YXMgbm90IGxpc3RlZCwgaW5zdGVhZCB3ZSdyZSBnb2luZyB0byBydW4gYCArXG4gICAgICAgICAgICBgJHt0aGlzLm9wdHMuYXBwUGFja2FnZX0gZGlyZWN0bHkgb24gdGhlIGRldmljZWApO1xuICAgICAgICBhd2FpdCB0aGlzLmNoZWNrUGFja2FnZVByZXNlbnQoKTtcbiAgICAgIH1cbiAgICAgIHRoaXMub3B0cy5zeXN0ZW1Qb3J0ID0gdGhpcy5vcHRzLnN5c3RlbVBvcnQgfHwgYXdhaXQgZmluZEFQb3J0Tm90SW5Vc2UoU1lTVEVNX1BPUlRfUkFOR0VbMF0sIFNZU1RFTV9QT1JUX1JBTkdFWzFdKTtcbiAgICAgIHRoaXMub3B0cy5hZGJQb3J0ID0gdGhpcy5vcHRzLmFkYlBvcnQgfHwgREVGQVVMVF9BREJfUE9SVDtcblxuICAgICAgYXdhaXQgdGhpcy5zdGFydFVpQXV0b21hdG9yMlNlc3Npb24oKTtcbiAgICAgIGF3YWl0IHRoaXMuZmlsbERldmljZURldGFpbHMoKTtcbiAgICAgIGlmICh0aGlzLm9wdHMubWpwZWdTY3JlZW5zaG90VXJsKSB7XG4gICAgICAgIGxvZ2dlci5pbmZvKGBTdGFydGluZyBNSlBFRyBzdHJlYW0gcmVhZGluZyBVUkw6ICcke3RoaXMub3B0cy5tanBlZ1NjcmVlbnNob3RVcmx9J2ApO1xuICAgICAgICB0aGlzLm1qcGVnU3RyZWFtID0gbmV3IG1qcGVnLk1KcGVnU3RyZWFtKHRoaXMub3B0cy5tanBlZ1NjcmVlbnNob3RVcmwpO1xuICAgICAgICBhd2FpdCB0aGlzLm1qcGVnU3RyZWFtLnN0YXJ0KCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gW3Nlc3Npb25JZCwgdGhpcy5jYXBzXTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBhd2FpdCB0aGlzLmRlbGV0ZVNlc3Npb24oKTtcbiAgICAgIHRocm93IGU7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZmlsbERldmljZURldGFpbHMgKCkge1xuICAgIHRoaXMuY2Fwcy5waXhlbFJhdGlvID0gYXdhaXQgdGhpcy5nZXREZXZpY2VQaXhlbFJhdGlvKCk7XG4gICAgdGhpcy5jYXBzLnN0YXRCYXJIZWlnaHQgPSBhd2FpdCB0aGlzLmdldFN0YXR1c0JhckhlaWdodCgpO1xuICAgIHRoaXMuY2Fwcy52aWV3cG9ydFJlY3QgPSBhd2FpdCB0aGlzLmdldFZpZXdQb3J0UmVjdCgpO1xuICB9XG5cbiAgZ2V0IGRyaXZlckRhdGEgKCkge1xuICAgIC8vIFRPRE8gZmlsbCBvdXQgcmVzb3VyY2UgaW5mbyBoZXJlXG4gICAgcmV0dXJuIHt9O1xuICB9XG5cbiAgYXN5bmMgZ2V0U2Vzc2lvbiAoKSB7XG4gICAgbGV0IHNlc3Npb25EYXRhID0gYXdhaXQgc3VwZXIuZ2V0U2Vzc2lvbigpO1xuICAgIGxvZ2dlci5kZWJ1ZyhcIkdldHRpbmcgc2Vzc2lvbiBkZXRhaWxzIGZyb20gc2VydmVyIHRvIG1peCBpblwiKTtcbiAgICBsZXQgdWlhMkRhdGEgPSBhd2FpdCB0aGlzLnVpYXV0b21hdG9yMi5qd3Byb3h5LmNvbW1hbmQoJy8nLCAnR0VUJywge30pO1xuICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBzZXNzaW9uRGF0YSwgdWlhMkRhdGEpO1xuICB9XG5cbiAgaXNFbXVsYXRvciAoKSB7XG4gICAgcmV0dXJuICEhKHRoaXMub3B0cy5hdmQgfHwgL2VtdWxhdG9yLy50ZXN0KHRoaXMub3B0cy51ZGlkKSk7XG4gIH1cblxuICBzZXRBdmRGcm9tQ2FwYWJpbGl0aWVzIChjYXBzKSB7XG4gICAgaWYgKHRoaXMub3B0cy5hdmQpIHtcbiAgICAgIGxvZ2dlci5pbmZvKCdhdmQgbmFtZSBkZWZpbmVkLCBpZ25vcmluZyBkZXZpY2UgbmFtZSBhbmQgcGxhdGZvcm0gdmVyc2lvbicpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoIWNhcHMuZGV2aWNlTmFtZSkge1xuICAgICAgICBsb2dnZXIuZXJyb3JBbmRUaHJvdygnYXZkIG9yIGRldmljZU5hbWUgc2hvdWxkIGJlIHNwZWNpZmllZCB3aGVuIHJlYm9vdCBvcHRpb24gaXMgZW5hYmxlcycpO1xuICAgICAgfVxuICAgICAgaWYgKCFjYXBzLnBsYXRmb3JtVmVyc2lvbikge1xuICAgICAgICBsb2dnZXIuZXJyb3JBbmRUaHJvdygnYXZkIG9yIHBsYXRmb3JtVmVyc2lvbiBzaG91bGQgYmUgc3BlY2lmaWVkIHdoZW4gcmVib290IG9wdGlvbiBpcyBlbmFibGVkJyk7XG4gICAgICB9XG4gICAgICBsZXQgYXZkRGV2aWNlID0gY2Fwcy5kZXZpY2VOYW1lLnJlcGxhY2UoL1teYS16QS1aMC05Xy5dL2csIFwiLVwiKTtcbiAgICAgIHRoaXMub3B0cy5hdmQgPSBgJHthdmREZXZpY2V9X18ke2NhcHMucGxhdGZvcm1WZXJzaW9ufWA7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgc3RhcnRVaUF1dG9tYXRvcjJTZXNzaW9uICgpIHtcbiAgICBpZiAoIXRoaXMub3B0cy5qYXZhVmVyc2lvbikge1xuICAgICAgdGhpcy5vcHRzLmphdmFWZXJzaW9uID0gYXdhaXQgaGVscGVycy5nZXRKYXZhVmVyc2lvbigpO1xuICAgIH1cblxuICAgIC8vIGdldCBkZXZpY2UgdWRpZCBmb3IgdGhpcyBzZXNzaW9uXG4gICAgbGV0IHt1ZGlkLCBlbVBvcnR9ID0gYXdhaXQgaGVscGVycy5nZXREZXZpY2VJbmZvRnJvbUNhcHModGhpcy5vcHRzKTtcbiAgICB0aGlzLm9wdHMudWRpZCA9IHVkaWQ7XG4gICAgdGhpcy5vcHRzLmVtUG9ydCA9IGVtUG9ydDtcblxuICAgIC8vIG5vdyB0aGF0IHdlIGtub3cgb3VyIGphdmEgdmVyc2lvbiBhbmQgZGV2aWNlIGluZm8sIHdlIGNhbiBjcmVhdGUgb3VyXG4gICAgLy8gQURCIGluc3RhbmNlXG4gICAgdGhpcy5hZGIgPSBhd2FpdCBhbmRyb2lkSGVscGVycy5jcmVhdGVBREIodGhpcy5vcHRzKTtcblxuICAgIGlmIChhd2FpdCB0aGlzLmFkYi5nZXRBcGlMZXZlbCgpIDwgMjEpIHtcbiAgICAgIGxvZ2dlci5lcnJvckFuZFRocm93KCdVSUF1dG9tYXRpb24yIGlzIG9ubHkgc3VwcG9ydGVkIHNpbmNlIEFuZHJvaWQgNS4wIChMb2xsaXBvcCkuICcgK1xuICAgICAgICAnWW91IGNvdWxkIHN0aWxsIHVzZSBvdGhlciBzdXBwb3J0ZWQgYmFja2VuZHMgaW4gb3JkZXIgdG8gYXV0b21hdGUgb2xkZXIgQW5kcm9pZCB2ZXJzaW9ucy4nKTtcbiAgICB9XG5cbiAgICAvLyBnZXQgYXBwUGFja2FnZSBldCBhbCBmcm9tIG1hbmlmZXN0IGlmIG5lY2Vzc2FyeVxuICAgIGxldCBhcHBJbmZvID0gYXdhaXQgaGVscGVycy5nZXRMYXVuY2hJbmZvKHRoaXMuYWRiLCB0aGlzLm9wdHMpO1xuICAgIC8vIGFuZCBnZXQgaXQgb250byBvdXIgJ29wdHMnIG9iamVjdCBzbyB3ZSB1c2UgaXQgZnJvbSBub3cgb25cbiAgICBPYmplY3QuYXNzaWduKHRoaXMub3B0cywgYXBwSW5mbyk7XG5cbiAgICAvLyBzZXQgYWN0dWFsIGRldmljZSBuYW1lLCB1ZGlkLCBwbGF0Zm9ybSB2ZXJzaW9uLCBzY3JlZW4gc2l6ZSwgc2NyZWVuIGRlbnNpdHksIG1vZGVsIGFuZCBtYW51ZmFjdHVyZXIgZGV0YWlsc1xuICAgIHRoaXMuY2Fwcy5kZXZpY2VOYW1lID0gdGhpcy5hZGIuY3VyRGV2aWNlSWQ7XG4gICAgdGhpcy5jYXBzLmRldmljZVVESUQgPSB0aGlzLm9wdHMudWRpZDtcblxuICAgIC8vIHNldCB1cCB0aGUgbW9kaWZpZWQgVWlBdXRvbWF0b3IyIHNlcnZlciBldGNcbiAgICBhd2FpdCB0aGlzLmluaXRVaUF1dG9tYXRvcjJTZXJ2ZXIoKTtcblxuICAgIC8vIHN0YXJ0IGFuIGF2ZCwgc2V0IHRoZSBsYW5ndWFnZS9sb2NhbGUsIHBpY2sgYW4gZW11bGF0b3IsIGV0Yy4uLlxuICAgIC8vIFRPRE8gd2l0aCBtdWx0aXBsZSBkZXZpY2VzIHdlJ2xsIG5lZWQgdG8gcGFyYW1ldGVyaXplIHRoaXNcbiAgICB0aGlzLmRlZmF1bHRJTUUgPSBhd2FpdCBoZWxwZXJzLmluaXREZXZpY2UodGhpcy5hZGIsIHRoaXMub3B0cyk7XG5cbiAgICAvLyBGdXJ0aGVyIHByZXBhcmUgdGhlIGRldmljZSBieSBmb3J3YXJkaW5nIHRoZSBVaUF1dG9tYXRvcjIgcG9ydFxuICAgIGxvZ2dlci5kZWJ1ZyhgRm9yd2FyZGluZyBVaUF1dG9tYXRvcjIgU2VydmVyIHBvcnQgJHtERVZJQ0VfUE9SVH0gdG8gJHt0aGlzLm9wdHMuc3lzdGVtUG9ydH1gKTtcbiAgICBhd2FpdCB0aGlzLmFkYi5mb3J3YXJkUG9ydCh0aGlzLm9wdHMuc3lzdGVtUG9ydCwgREVWSUNFX1BPUlQpO1xuXG4gICAgLy8gSWYgdGhlIHVzZXIgc2V0cyBhdXRvTGF1bmNoIHRvIGZhbHNlLCB0aGV5IGFyZSByZXNwb25zaWJsZSBmb3IgaW5pdEFVVCgpIGFuZCBzdGFydEFVVCgpXG4gICAgaWYgKHRoaXMub3B0cy5hdXRvTGF1bmNoKSB7XG4gICAgICAvLyBzZXQgdXAgYXBwIHVuZGVyIHRlc3RcbiAgICAgIC8vIHByZXBhcmUgb3VyIGFjdHVhbCBBVVQsIGdldCBpdCBvbiB0aGUgZGV2aWNlLCBldGMuLi5cbiAgICAgIGF3YWl0IHRoaXMuaW5pdEFVVCgpO1xuICAgIH1cbiAgICAvLyBBZGRpbmcgQVVUIHBhY2thZ2UgbmFtZSBpbiB0aGUgY2FwYWJpbGl0aWVzIGlmIHBhY2thZ2UgbmFtZSBub3QgZXhpc3QgaW4gY2Fwc1xuICAgIGlmICghdGhpcy5jYXBzLmFwcFBhY2thZ2UgJiYgYXBwSW5mbykge1xuICAgICAgdGhpcy5jYXBzLmFwcFBhY2thZ2UgPSBhcHBJbmZvLmFwcFBhY2thZ2U7XG4gICAgfVxuXG4gICAgLy8gbGF1bmNoIFVpQXV0b21hdG9yMiBhbmQgd2FpdCB0aWxsIGl0cyBvbmxpbmUgYW5kIHdlIGhhdmUgYSBzZXNzaW9uXG4gICAgYXdhaXQgdGhpcy51aWF1dG9tYXRvcjIuc3RhcnRTZXNzaW9uKHRoaXMuY2Fwcyk7XG5cbiAgICBhd2FpdCB0aGlzLmFkZERldmljZUluZm9Ub0NhcHMoKTtcblxuICAgIC8vIFVubG9jayB0aGUgZGV2aWNlIGFmdGVyIHRoZSBzZXNzaW9uIGlzIHN0YXJ0ZWQuXG4gICAgaWYgKCF0aGlzLm9wdHMuc2tpcFVubG9jaykge1xuICAgICAgLy8gdW5sb2NrIHRoZSBkZXZpY2UgdG8gcHJlcGFyZSBpdCBmb3IgdGVzdGluZ1xuICAgICAgYXdhaXQgaGVscGVycy51bmxvY2sodGhpcywgdGhpcy5hZGIsIHRoaXMuY2Fwcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxvZ2dlci5kZWJ1ZyhgJ3NraXBVbmxvY2snIGNhcGFiaWxpdHkgc2V0LCBzbyBza2lwcGluZyBkZXZpY2UgdW5sb2NrYCk7XG4gICAgfVxuXG4gICAgLy8gcmVzY3VlIFVpQXV0b21hdG9yMiBpZiBpdCBmYWlscyB0byBzdGFydCBvdXIgQVVUXG4gICAgaWYgKHRoaXMub3B0cy5hdXRvTGF1bmNoKSB7XG4gICAgICBhd2FpdCB0aGlzLmVuc3VyZUFwcFN0YXJ0cygpO1xuICAgIH1cblxuICAgIC8vIGlmIHRoZSBpbml0aWFsIG9yaWVudGF0aW9uIGlzIHJlcXVlc3RlZCwgc2V0IGl0XG4gICAgaWYgKHV0aWwuaGFzVmFsdWUodGhpcy5vcHRzLm9yaWVudGF0aW9uKSkge1xuICAgICAgbG9nZ2VyLmRlYnVnKGBTZXR0aW5nIGluaXRpYWwgb3JpZW50YXRpb24gdG8gJyR7dGhpcy5vcHRzLm9yaWVudGF0aW9ufSdgKTtcbiAgICAgIGF3YWl0IHRoaXMuc2V0T3JpZW50YXRpb24odGhpcy5vcHRzLm9yaWVudGF0aW9uKTtcbiAgICB9XG5cbiAgICAvLyBpZiB3ZSB3YW50IHRvIGltbWVkaWF0ZWx5IGdldCBpbnRvIGEgd2Vidmlldywgc2V0IG91ciBjb250ZXh0XG4gICAgLy8gYXBwcm9wcmlhdGVseVxuICAgIGlmICh0aGlzLm9wdHMuYXV0b1dlYnZpZXcpIHtcbiAgICAgIGNvbnN0IHZpZXdOYW1lID0gdGhpcy5kZWZhdWx0V2Vidmlld05hbWUoKTtcbiAgICAgIGNvbnN0IHRpbWVvdXQgPSB0aGlzLm9wdHMuYXV0b1dlYnZpZXdUaW1lb3V0IHx8IDIwMDA7XG4gICAgICBsb2dnZXIuaW5mbyhgU2V0dGluZyBhdXRvIHdlYnZpZXcgdG8gY29udGV4dCAnJHt2aWV3TmFtZX0nIHdpdGggdGltZW91dCAke3RpbWVvdXR9bXNgKTtcbiAgICAgIGF3YWl0IHJldHJ5SW50ZXJ2YWwodGltZW91dCAvIDUwMCwgNTAwLCB0aGlzLnNldENvbnRleHQuYmluZCh0aGlzKSwgdmlld05hbWUpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmlzQ2hyb21lU2Vzc2lvbikge1xuICAgICAgYXdhaXQgdGhpcy5zdGFydENocm9tZVNlc3Npb24odGhpcyk7XG4gICAgfVxuXG4gICAgLy8gbm93IHRoYXQgZXZlcnl0aGluZyBoYXMgc3RhcnRlZCBzdWNjZXNzZnVsbHksIHR1cm4gb24gcHJveHlpbmcgc28gYWxsXG4gICAgLy8gc3Vic2VxdWVudCBzZXNzaW9uIHJlcXVlc3RzIGdvIHN0cmFpZ2h0IHRvL2Zyb20gdWlhdXRvbWF0b3IyXG4gICAgdGhpcy5qd3BQcm94eUFjdGl2ZSA9IHRydWU7XG4gIH1cblxuICBhc3luYyBhZGREZXZpY2VJbmZvVG9DYXBzICgpIHtcbiAgICBjb25zdCB7XG4gICAgICBhcGlWZXJzaW9uLFxuICAgICAgcGxhdGZvcm1WZXJzaW9uLFxuICAgICAgbWFudWZhY3R1cmVyLFxuICAgICAgbW9kZWwsXG4gICAgICByZWFsRGlzcGxheVNpemUsXG4gICAgICBkaXNwbGF5RGVuc2l0eSxcbiAgICB9ID0gYXdhaXQgdGhpcy5tb2JpbGVHZXREZXZpY2VJbmZvKCk7XG4gICAgdGhpcy5jYXBzLmRldmljZUFwaUxldmVsID0gcGFyc2VJbnQoYXBpVmVyc2lvbiwgMTApO1xuICAgIHRoaXMuY2Fwcy5wbGF0Zm9ybVZlcnNpb24gPSBwbGF0Zm9ybVZlcnNpb247XG4gICAgdGhpcy5jYXBzLmRldmljZVNjcmVlblNpemUgPSByZWFsRGlzcGxheVNpemU7XG4gICAgdGhpcy5jYXBzLmRldmljZVNjcmVlbkRlbnNpdHkgPSBkaXNwbGF5RGVuc2l0eTtcbiAgICB0aGlzLmNhcHMuZGV2aWNlTW9kZWwgPSBtb2RlbDtcbiAgICB0aGlzLmNhcHMuZGV2aWNlTWFudWZhY3R1cmVyID0gbWFudWZhY3R1cmVyO1xuICB9XG5cbiAgYXN5bmMgaW5pdFVpQXV0b21hdG9yMlNlcnZlciAoKSB7XG4gICAgLy8gbm93IHRoYXQgd2UgaGF2ZSBwYWNrYWdlIGFuZCBhY3Rpdml0eSwgd2UgY2FuIGNyZWF0ZSBhbiBpbnN0YW5jZSBvZlxuICAgIC8vIHVpYXV0b21hdG9yMiB3aXRoIHRoZSBhcHByb3ByaWF0ZSBkYXRhXG4gICAgdGhpcy51aWF1dG9tYXRvcjIgPSBuZXcgVWlBdXRvbWF0b3IyU2VydmVyKHtcbiAgICAgIGhvc3Q6IHRoaXMub3B0cy5yZW1vdGVBZGJIb3N0IHx8IHRoaXMub3B0cy5ob3N0IHx8ICdsb2NhbGhvc3QnLFxuICAgICAgc3lzdGVtUG9ydDogdGhpcy5vcHRzLnN5c3RlbVBvcnQsXG4gICAgICBkZXZpY2VQb3J0OiBERVZJQ0VfUE9SVCxcbiAgICAgIGFkYjogdGhpcy5hZGIsXG4gICAgICBhcGs6IHRoaXMub3B0cy5hcHAsXG4gICAgICB0bXBEaXI6IHRoaXMub3B0cy50bXBEaXIsXG4gICAgICBhcHBQYWNrYWdlOiB0aGlzLm9wdHMuYXBwUGFja2FnZSxcbiAgICAgIGFwcEFjdGl2aXR5OiB0aGlzLm9wdHMuYXBwQWN0aXZpdHksXG4gICAgICBkaXNhYmxlV2luZG93QW5pbWF0aW9uOiAhIXRoaXMub3B0cy5kaXNhYmxlV2luZG93QW5pbWF0aW9uLFxuICAgIH0pO1xuICAgIHRoaXMucHJveHlSZXFSZXMgPSB0aGlzLnVpYXV0b21hdG9yMi5wcm94eVJlcVJlcy5iaW5kKHRoaXMudWlhdXRvbWF0b3IyKTtcblxuICAgIC8vIGtpbGxpbmcgYW55IHVpYXV0b21hdG9yIGV4aXN0aW5nIHByb2Nlc3Nlc1xuICAgIGF3YWl0IHRoaXMudWlhdXRvbWF0b3IyLmtpbGxVaUF1dG9tYXRvck9uRGV2aWNlKCk7XG5cbiAgICBhd2FpdCB0aGlzLnVpYXV0b21hdG9yMi5pbnN0YWxsU2VydmVyQXBrKHRoaXMub3B0cy51aWF1dG9tYXRvcjJTZXJ2ZXJJbnN0YWxsVGltZW91dCk7XG4gIH1cblxuICBhc3luYyBpbml0QVVUICgpIHtcbiAgICAvLyBJbnN0YWxsIGFueSBcIm90aGVyQXBwc1wiIHRoYXQgd2VyZSBzcGVjaWZpZWQgaW4gY2Fwc1xuICAgIGlmICh0aGlzLm9wdHMub3RoZXJBcHBzKSB7XG4gICAgICBsZXQgb3RoZXJBcHBzO1xuICAgICAgdHJ5IHtcbiAgICAgICAgb3RoZXJBcHBzID0gaGVscGVycy5wYXJzZUFycmF5KHRoaXMub3B0cy5vdGhlckFwcHMpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBsb2dnZXIuZXJyb3JBbmRUaHJvdyhgQ291bGQgbm90IHBhcnNlIFwib3RoZXJBcHBzXCIgY2FwYWJpbGl0eTogJHtlLm1lc3NhZ2V9YCk7XG4gICAgICB9XG4gICAgICBvdGhlckFwcHMgPSBhd2FpdCBCLmFsbChvdGhlckFwcHMubWFwKChhcHApID0+IHRoaXMuaGVscGVycy5jb25maWd1cmVBcHAoYXBwLCBBUFBfRVhURU5TSU9OKSkpO1xuICAgICAgYXdhaXQgaGVscGVycy5pbnN0YWxsT3RoZXJBcGtzKG90aGVyQXBwcywgdGhpcy5hZGIsIHRoaXMub3B0cyk7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLm9wdHMuYXBwKSB7XG4gICAgICBpZiAodGhpcy5vcHRzLmZ1bGxSZXNldCkge1xuICAgICAgICBsb2dnZXIuZXJyb3JBbmRUaHJvdygnRnVsbCByZXNldCByZXF1aXJlcyBhbiBhcHAgY2FwYWJpbGl0eSwgdXNlIGZhc3RSZXNldCBpZiBhcHAgaXMgbm90IHByb3ZpZGVkJyk7XG4gICAgICB9XG4gICAgICBsb2dnZXIuZGVidWcoJ05vIGFwcCBjYXBhYmlsaXR5LiBBc3N1bWluZyBpdCBpcyBhbHJlYWR5IG9uIHRoZSBkZXZpY2UnKTtcbiAgICAgIGlmICh0aGlzLm9wdHMuZmFzdFJlc2V0KSB7XG4gICAgICAgIGF3YWl0IGhlbHBlcnMucmVzZXRBcHAodGhpcy5hZGIsIHRoaXMub3B0cyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLm9wdHMuc2tpcFVuaW5zdGFsbCkge1xuICAgICAgYXdhaXQgdGhpcy5hZGIudW5pbnN0YWxsQXBrKHRoaXMub3B0cy5hcHBQYWNrYWdlKTtcbiAgICB9XG4gICAgaWYgKCF0aGlzLm9wdHMubm9TaWduKSB7XG4gICAgICBsZXQgc2lnbmVkID0gYXdhaXQgdGhpcy5hZGIuY2hlY2tBcGtDZXJ0KHRoaXMub3B0cy5hcHAsIHRoaXMub3B0cy5hcHBQYWNrYWdlKTtcbiAgICAgIGlmICghc2lnbmVkICYmIHRoaXMub3B0cy5hcHApIHtcbiAgICAgICAgYXdhaXQgdGhpcy5hZGIuc2lnbih0aGlzLm9wdHMuYXBwLCB0aGlzLm9wdHMuYXBwUGFja2FnZSk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmICh0aGlzLm9wdHMuYXBwKSB7XG4gICAgICBhd2FpdCBoZWxwZXJzLmluc3RhbGxBcGsodGhpcy5hZGIsIHRoaXMub3B0cyk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZW5zdXJlQXBwU3RhcnRzICgpIHtcbiAgICAvLyBtYWtlIHN1cmUgd2UgaGF2ZSBhbiBhY3Rpdml0eSBhbmQgcGFja2FnZSB0byB3YWl0IGZvclxuICAgIGxldCBhcHBXYWl0UGFja2FnZSA9IHRoaXMub3B0cy5hcHBXYWl0UGFja2FnZSB8fCB0aGlzLm9wdHMuYXBwUGFja2FnZTtcbiAgICBsZXQgYXBwV2FpdEFjdGl2aXR5ID0gdGhpcy5vcHRzLmFwcFdhaXRBY3Rpdml0eSB8fCB0aGlzLm9wdHMuYXBwQWN0aXZpdHk7XG5cbiAgICBsb2dnZXIuaW5mbyhgVWlBdXRvbWF0b3IyIGRpZCBub3Qgc3RhcnQgdGhlIGFjdGl2aXR5IHdlIHdlcmUgd2FpdGluZyBmb3IsIGAgK1xuICAgICAgICBgJyR7YXBwV2FpdFBhY2thZ2V9LyR7YXBwV2FpdEFjdGl2aXR5fScuIFN0YXJ0aW5nIGl0IG91cnNlbHZlc2ApO1xuXG4gICAgaWYgKHRoaXMuY2Fwcy5hbmRyb2lkQ292ZXJhZ2UpIHtcbiAgICAgIGxvZ2dlci5pbmZvKGBhbmRyb2lkQ292ZXJhZ2UgaXMgY29uZmlndXJlZC4gYCArXG4gICAgICAgIGAgU3RhcnRpbmcgaW5zdHJ1bWVudGF0aW9uIG9mICcke3RoaXMuY2Fwcy5hbmRyb2lkQ292ZXJhZ2V9Jy4uLmApO1xuICAgICAgYXdhaXQgdGhpcy5hZGIuYW5kcm9pZENvdmVyYWdlKHRoaXMuY2Fwcy5hbmRyb2lkQ292ZXJhZ2UsIGFwcFdhaXRQYWNrYWdlLCBhcHBXYWl0QWN0aXZpdHkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBhd2FpdCB0aGlzLmFkYi5zdGFydEFwcCh7XG4gICAgICAgIHBrZzogdGhpcy5vcHRzLmFwcFBhY2thZ2UsXG4gICAgICAgIGFjdGl2aXR5OiB0aGlzLm9wdHMuYXBwQWN0aXZpdHksXG4gICAgICAgIGFjdGlvbjogdGhpcy5vcHRzLmludGVudEFjdGlvbixcbiAgICAgICAgY2F0ZWdvcnk6IHRoaXMub3B0cy5pbnRlbnRDYXRlZ29yeSxcbiAgICAgICAgZmxhZ3M6IHRoaXMub3B0cy5pbnRlbnRGbGFncyxcbiAgICAgICAgd2FpdFBrZzogdGhpcy5vcHRzLmFwcFdhaXRQYWNrYWdlLFxuICAgICAgICB3YWl0QWN0aXZpdHk6IHRoaXMub3B0cy5hcHBXYWl0QWN0aXZpdHksXG4gICAgICAgIG9wdGlvbmFsSW50ZW50QXJndW1lbnRzOiB0aGlzLm9wdHMub3B0aW9uYWxJbnRlbnRBcmd1bWVudHMsXG4gICAgICAgIHN0b3BBcHA6ICF0aGlzLm9wdHMuZG9udFN0b3BBcHBPblJlc2V0LFxuICAgICAgICByZXRyeTogdHJ1ZVxuICAgICAgfSk7XG4gICAgfVxuXG4gIH1cblxuICBhc3luYyBkZWxldGVTZXNzaW9uICgpIHtcbiAgICBsb2dnZXIuZGVidWcoJ0RlbGV0aW5nIFVpQXV0b21hdG9yMiBzZXNzaW9uJyk7XG4gICAgYXdhaXQgYW5kcm9pZEhlbHBlcnMucmVtb3ZlQWxsU2Vzc2lvbldlYlNvY2tldEhhbmRsZXJzKHRoaXMuc2VydmVyLCB0aGlzLnNlc3Npb25JZCk7XG4gICAgaWYgKHRoaXMudWlhdXRvbWF0b3IyKSB7XG4gICAgICB0cnkge1xuICAgICAgICBhd2FpdCB0aGlzLnN0b3BDaHJvbWVkcml2ZXJQcm94aWVzKCk7XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgbG9nZ2VyLndhcm4oYFVuYWJsZSB0byBzdG9wIENocm9tZURyaXZlciBwcm94aWVzOiAke2Vyci5tZXNzYWdlfWApO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMuandwUHJveHlBY3RpdmUpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBhd2FpdCB0aGlzLnVpYXV0b21hdG9yMi5kZWxldGVTZXNzaW9uKCk7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgIGxvZ2dlci53YXJuKGBVbmFibGUgdG8gcHJveHkgZGVsZXRlU2Vzc2lvbiB0byBVaUF1dG9tYXRvcjI6ICR7ZXJyLm1lc3NhZ2V9YCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHRoaXMudWlhdXRvbWF0b3IyID0gbnVsbDtcbiAgICB9XG4gICAgdGhpcy5qd3BQcm94eUFjdGl2ZSA9IGZhbHNlO1xuXG4gICAgaWYgKHRoaXMuYWRiKSB7XG4gICAgICBpZiAodGhpcy5vcHRzLnVuaWNvZGVLZXlib2FyZCAmJiB0aGlzLm9wdHMucmVzZXRLZXlib2FyZCAmJiB0aGlzLmRlZmF1bHRJTUUpIHtcbiAgICAgICAgbG9nZ2VyLmRlYnVnKGBSZXNldHRpbmcgSU1FIHRvICcke3RoaXMuZGVmYXVsdElNRX0nYCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5hZGIuc2V0SU1FKHRoaXMuZGVmYXVsdElNRSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgIGxvZ2dlci53YXJuKGBVbmFibGUgdG8gcmVzZXQgSU1FOiAke2Vyci5tZXNzYWdlfWApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5jYXBzLmFuZHJvaWRDb3ZlcmFnZSkge1xuICAgICAgICBsb2dnZXIuaW5mbygnU2h1dHRpbmcgZG93biB0aGUgYWRiIHByb2Nlc3Mgb2YgaW5zdHJ1bWVudGF0aW9uLi4uJyk7XG4gICAgICAgIGF3YWl0IHRoaXMuYWRiLmVuZEFuZHJvaWRDb3ZlcmFnZSgpO1xuICAgICAgICAvLyBVc2UgdGhpcyBicm9hZGNhc3QgaW50ZW50IHRvIG5vdGlmeSBpdCdzIHRpbWUgdG8gZHVtcCBjb3ZlcmFnZSB0byBmaWxlXG4gICAgICAgIGlmICh0aGlzLmNhcHMuYW5kcm9pZENvdmVyYWdlRW5kSW50ZW50KSB7XG4gICAgICAgICAgbG9nZ2VyLmluZm8oYFNlbmRpbmcgaW50ZW50IGJyb2FkY2FzdCAnJHt0aGlzLmNhcHMuYW5kcm9pZENvdmVyYWdlRW5kSW50ZW50fScgYXQgdGhlIGVuZCBvZiBpbnN0cnVtZW50aW5nLmApO1xuICAgICAgICAgIGF3YWl0IHRoaXMuYWRiLmJyb2FkY2FzdCh0aGlzLmNhcHMuYW5kcm9pZENvdmVyYWdlRW5kSW50ZW50KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBsb2dnZXIud2FybignTm8gYW5kcm9pZENvdmVyYWdlRW5kSW50ZW50IGlzIGNvbmZpZ3VyZWQgaW4gY2Fwcy4gUG9zc2libHkgeW91IGNhbm5vdCBnZXQgY292ZXJhZ2UgZmlsZS4nKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKHRoaXMub3B0cy5hcHBQYWNrYWdlKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5hZGIuZm9yY2VTdG9wKHRoaXMub3B0cy5hcHBQYWNrYWdlKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgbG9nZ2VyLndhcm4oYFVuYWJsZSB0byBmb3JjZSBzdG9wIGFwcDogJHtlcnIubWVzc2FnZX1gKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKHRoaXMub3B0cy5mdWxsUmVzZXQgJiYgIXRoaXMub3B0cy5za2lwVW5pbnN0YWxsICYmICF0aGlzLmFwcE9uRGV2aWNlKSB7XG4gICAgICAgIGxvZ2dlci5kZWJ1ZyhgQ2FwYWJpbGl0eSAnZnVsbFJlc2V0JyBzZXQgdG8gJ3RydWUnLCBVbmluc3RhbGxpbmcgJyR7dGhpcy5vcHRzLmFwcFBhY2thZ2V9J2ApO1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGF3YWl0IHRoaXMuYWRiLnVuaW5zdGFsbEFwayh0aGlzLm9wdHMuYXBwUGFja2FnZSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgIGxvZ2dlci53YXJuKGBVbmFibGUgdG8gdW5pbnN0YWxsIGFwcDogJHtlcnIubWVzc2FnZX1gKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgYXdhaXQgdGhpcy5hZGIuc3RvcExvZ2NhdCgpO1xuICAgICAgaWYgKHV0aWwuaGFzVmFsdWUodGhpcy5vcHRzLnN5c3RlbVBvcnQpKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5hZGIucmVtb3ZlUG9ydEZvcndhcmQodGhpcy5vcHRzLnN5c3RlbVBvcnQpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGxvZ2dlci53YXJuKGBVbmFibGUgdG8gcmVtb3ZlIHBvcnQgZm9yd2FyZCAnJHtlcnJvci5tZXNzYWdlfSdgKTtcbiAgICAgICAgICAvLyBJZ25vcmUsIHRoaXMgYmxvY2sgd2lsbCBhbHNvIGJlIGNhbGxlZCB3aGVuIHdlIGZhbGwgaW4gY2F0Y2ggYmxvY2tcbiAgICAgICAgICAvLyBhbmQgYmVmb3JlIGV2ZW4gcG9ydCBmb3J3YXJkLlxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5vcHRzLnJlYm9vdCkge1xuICAgICAgICBsZXQgYXZkTmFtZSA9IHRoaXMub3B0cy5hdmQucmVwbGFjZSgnQCcsICcnKTtcbiAgICAgICAgbG9nZ2VyLmRlYnVnKGBDbG9zaW5nIGVtdWxhdG9yICcke2F2ZE5hbWV9J2ApO1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGF3YWl0IHRoaXMuYWRiLmtpbGxFbXVsYXRvcihhdmROYW1lKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgbG9nZ2VyLndhcm4oYFVuYWJsZSB0byBjbG9zZSBlbXVsYXRvcjogJHtlcnIubWVzc2FnZX1gKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBpZiAodGhpcy5tanBlZ1N0cmVhbSkge1xuICAgICAgbG9nZ2VyLmluZm8oJ0Nsb3NpbmcgTUpQRUcgc3RyZWFtJyk7XG4gICAgICB0aGlzLm1qcGVnU3RyZWFtLnN0b3AoKTtcbiAgICB9XG4gICAgYXdhaXQgc3VwZXIuZGVsZXRlU2Vzc2lvbigpO1xuICB9XG5cbiAgYXN5bmMgY2hlY2tBcHBQcmVzZW50ICgpIHtcbiAgICBsb2dnZXIuZGVidWcoJ0NoZWNraW5nIHdoZXRoZXIgYXBwIGlzIGFjdHVhbGx5IHByZXNlbnQnKTtcbiAgICBpZiAoIShhd2FpdCBmcy5leGlzdHModGhpcy5vcHRzLmFwcCkpKSB7XG4gICAgICBsb2dnZXIuZXJyb3JBbmRUaHJvdyhgQ291bGQgbm90IGZpbmQgYXBwIGFwayBhdCAnJHt0aGlzLm9wdHMuYXBwfSdgKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBvblNldHRpbmdzVXBkYXRlICgpIHtcbiAgICAvLyBpbnRlbnRpb25hbGx5IGRvIG5vdGhpbmcgaGVyZSwgc2luY2UgY29tbWFuZHMudXBkYXRlU2V0dGluZ3MgcHJveGllc1xuICAgIC8vIHNldHRpbmdzIHRvIHRoZSB1aWF1dG8yIHNlcnZlciBhbHJlYWR5XG4gIH1cblxuICAvLyBOZWVkIHRvIG92ZXJyaWRlIGFuZHJvaWQtZHJpdmVyJ3MgdmVyc2lvbiBvZiB0aGlzIHNpbmNlIHdlIGRvbid0IGFjdHVhbGx5XG4gIC8vIGhhdmUgYSBib290c3RyYXA7IGluc3RlYWQgd2UganVzdCByZXN0YXJ0IGFkYiBhbmQgcmUtZm9yd2FyZCB0aGUgVWlBdXRvbWF0b3IyXG4gIC8vIHBvcnRcbiAgYXN5bmMgd3JhcEJvb3RzdHJhcERpc2Nvbm5lY3QgKHdyYXBwZWQpIHtcbiAgICBhd2FpdCB3cmFwcGVkKCk7XG4gICAgYXdhaXQgdGhpcy5hZGIucmVzdGFydCgpO1xuICAgIGF3YWl0IHRoaXMuYWRiLmZvcndhcmRQb3J0KHRoaXMub3B0cy5zeXN0ZW1Qb3J0LCBERVZJQ0VfUE9SVCk7XG4gIH1cblxuICBwcm94eUFjdGl2ZSAoc2Vzc2lvbklkKSB7XG4gICAgc3VwZXIucHJveHlBY3RpdmUoc2Vzc2lvbklkKTtcblxuICAgIC8vIHdlIGFsd2F5cyBoYXZlIGFuIGFjdGl2ZSBwcm94eSB0byB0aGUgVWlBdXRvbWF0b3IyIHNlcnZlclxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgY2FuUHJveHkgKHNlc3Npb25JZCkge1xuICAgIHN1cGVyLmNhblByb3h5KHNlc3Npb25JZCk7XG5cbiAgICAvLyB3ZSBjYW4gYWx3YXlzIHByb3h5IHRvIHRoZSB1aWF1dG9tYXRvcjIgc2VydmVyXG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICBnZXRQcm94eUF2b2lkTGlzdCAoc2Vzc2lvbklkKSB7XG4gICAgc3VwZXIuZ2V0UHJveHlBdm9pZExpc3Qoc2Vzc2lvbklkKTtcbiAgICAvLyB3ZSBhcmUgbWFpbnRhaW5pbmcgdHdvIHNldHMgb2YgTk9fUFJPWFkgbGlzdHMsIG9uZSBmb3IgY2hyb21lZHJpdmVyKENIUk9NRV9OT19QUk9YWSlcbiAgICAvLyBhbmQgb25lIGZvciB1aWF1dG9tYXRvcjIoTk9fUFJPWFkpLCBiYXNlZCBvbiBjdXJyZW50IGNvbnRleHQgd2lsbCByZXR1cm4gcmVsYXRlZCBOT19QUk9YWSBsaXN0XG4gICAgaWYgKHV0aWwuaGFzVmFsdWUodGhpcy5jaHJvbWVkcml2ZXIpKSB7XG4gICAgICAvLyBpZiB0aGUgY3VycmVudCBjb250ZXh0IGlzIHdlYnZpZXcoY2hyb21lZHJpdmVyKSwgdGhlbiByZXR1cm4gQ0hST01FX05PX1BST1hZIGxpc3RcbiAgICAgIHRoaXMuandwUHJveHlBdm9pZCA9IENIUk9NRV9OT19QUk9YWTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5qd3BQcm94eUF2b2lkID0gTk9fUFJPWFk7XG4gICAgfVxuICAgIGlmICh0aGlzLm9wdHMubmF0aXZlV2ViU2NyZWVuc2hvdCkge1xuICAgICAgdGhpcy5qd3BQcm94eUF2b2lkID0gWy4uLnRoaXMuandwUHJveHlBdm9pZCwgWydHRVQnLCBuZXcgUmVnRXhwKCdeL3Nlc3Npb24vW14vXSsvc2NyZWVuc2hvdCcpXV07XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuandwUHJveHlBdm9pZDtcbiAgfVxuXG4gIGdldCBpc0Nocm9tZVNlc3Npb24gKCkge1xuICAgIHJldHVybiBoZWxwZXJzLmlzQ2hyb21lQnJvd3Nlcih0aGlzLm9wdHMuYnJvd3Nlck5hbWUpO1xuICB9XG59XG5cbi8vIGZpcnN0IGFkZCB0aGUgYW5kcm9pZC1kcml2ZXIgY29tbWFuZHMgd2hpY2ggd2Ugd2lsbCBmYWxsIGJhY2sgdG9cbmZvciAobGV0IFtjbWQsIGZuXSBvZiBfLnRvUGFpcnMoYW5kcm9pZENvbW1hbmRzKSkge1xuICBBbmRyb2lkVWlhdXRvbWF0b3IyRHJpdmVyLnByb3RvdHlwZVtjbWRdID0gZm47XG59XG5cbi8vIHRoZW4gb3ZlcndyaXRlIHdpdGggYW55IHVpYXV0b21hdG9yMi1zcGVjaWZpYyBjb21tYW5kc1xuZm9yIChsZXQgW2NtZCwgZm5dIG9mIF8udG9QYWlycyhjb21tYW5kcykpIHtcbiAgQW5kcm9pZFVpYXV0b21hdG9yMkRyaXZlci5wcm90b3R5cGVbY21kXSA9IGZuO1xufVxuXG5leHBvcnQgeyBBbmRyb2lkVWlhdXRvbWF0b3IyRHJpdmVyIH07XG5leHBvcnQgZGVmYXVsdCBBbmRyb2lkVWlhdXRvbWF0b3IyRHJpdmVyO1xuIl0sImZpbGUiOiJsaWIvZHJpdmVyLmpzIiwic291cmNlUm9vdCI6Ii4uLy4uIn0=
