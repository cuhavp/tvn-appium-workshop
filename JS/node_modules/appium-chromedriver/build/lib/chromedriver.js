"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getMostRecentChromedriver = getMostRecentChromedriver;
exports.default = exports.CD_VER = exports.CHROMEDRIVER_CHROME_MAPPING = exports.Chromedriver = void 0;

var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));

var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));

var _events = _interopRequireDefault(require("events"));

var _appiumBaseDriver = require("appium-base-driver");

var _child_process = _interopRequireDefault(require("child_process"));

var _appiumSupport = require("appium-support");

var _asyncbox = require("asyncbox");

var _teen_process = require("teen_process");

var _bluebird = _interopRequireDefault(require("bluebird"));

var _utils = require("./utils");

var _semver = _interopRequireDefault(require("semver"));

var _lodash = _interopRequireDefault(require("lodash"));

var _path = _interopRequireDefault(require("path"));

const log = _appiumSupport.logger.getLogger('Chromedriver');

const DEFAULT_HOST = '127.0.0.1';
const DEFAULT_PORT = 9515;
const CHROMEDRIVER_CHROME_MAPPING = {
  '2.43': '69.0.3497',
  '2.42': '68.0.3440',
  '2.41': '67.0.3396',
  '2.40': '66.0.3359',
  '2.39': '66.0.3359',
  '2.38': '65.0.3325',
  '2.37': '64.0.3282',
  '2.36': '63.0.3239',
  '2.35': '62.0.3202',
  '2.34': '61.0.3163',
  '2.33': '60.0.3112',
  '2.32': '59.0.3071',
  '2.31': '58.0.3029',
  '2.30': '58.0.3029',
  '2.29': '57.0.2987',
  '2.28': '55.0.2883',
  '2.27': '54.0.2840',
  '2.26': '53.0.2785',
  '2.25': '53.0.2785',
  '2.24': '52.0.2743',
  '2.23': '51.0.2704',
  '2.22': '49.0.2623',
  '2.21': '46.0.2490',
  '2.20': '43.0.2357',
  '2.19': '43.0.2357',
  '2.18': '43.0.2357',
  '2.17': '42.0.2311',
  '2.16': '42.0.2311',
  '2.15': '40.0.2214',
  '2.14': '39.0.2171',
  '2.13': '38.0.2125',
  '2.12': '36.0.1985',
  '2.11': '36.0.1985',
  '2.10': '33.0.1751',
  '2.9': '31.0.1650',
  '2.8': '30.0.1573',
  '2.7': '30.0.1573',
  '2.6': '29.0.1545',
  '2.5': '29.0.1545',
  '2.4': '29.0.1545',
  '2.3': '28.0.1500',
  '2.2': '27.0.1453',
  '2.1': '27.0.1453',
  '2.0': '27.0.1453'
};
exports.CHROMEDRIVER_CHROME_MAPPING = CHROMEDRIVER_CHROME_MAPPING;
const CHROME_BUNDLE_ID = 'com.android.chrome';
const WEBVIEW_BUNDLE_IDS = ['com.google.android.webview', 'com.android.webview'];
const CD_VER = process.env.npm_config_chromedriver_version || process.env.CHROMEDRIVER_VERSION || getMostRecentChromedriver();
exports.CD_VER = CD_VER;

function getMostRecentChromedriver(mapping = CHROMEDRIVER_CHROME_MAPPING) {
  if (_lodash.default.isEmpty(mapping)) {
    throw new Error('Unable to get most recent Chromedriver from empty mapping');
  }

  return _lodash.default.keys(mapping).map(_semver.default.coerce).sort(_semver.default.rcompare).map(v => `${_semver.default.major(v)}.${_semver.default.minor(v)}`)[0];
}

class Chromedriver extends _events.default.EventEmitter {
  constructor(args = {}) {
    super();
    const _args$host = args.host,
          host = _args$host === void 0 ? DEFAULT_HOST : _args$host,
          _args$port = args.port,
          port = _args$port === void 0 ? DEFAULT_PORT : _args$port,
          _args$useSystemExecut = args.useSystemExecutable,
          useSystemExecutable = _args$useSystemExecut === void 0 ? false : _args$useSystemExecut,
          executable = args.executable,
          _args$executableDir = args.executableDir,
          executableDir = _args$executableDir === void 0 ? (0, _utils.getChromedriverDir)() : _args$executableDir,
          bundleId = args.bundleId,
          mappingPath = args.mappingPath,
          cmdArgs = args.cmdArgs,
          adb = args.adb,
          verbose = args.verbose,
          logPath = args.logPath;
    this.proxyHost = host;
    this.proxyPort = port;
    this.adb = adb;
    this.cmdArgs = cmdArgs;
    this.proc = null;
    this.useSystemExecutable = useSystemExecutable;
    this.chromedriver = executable;
    this.executableDir = executableDir;
    this.mappingPath = mappingPath;
    this.bundleId = bundleId;
    this.executableVerified = false;
    this.state = Chromedriver.STATE_STOPPED;
    this.jwproxy = new _appiumBaseDriver.JWProxy({
      server: this.proxyHost,
      port: this.proxyPort
    });
    this.verbose = verbose;
    this.logPath = logPath;
  }

  getMapping() {
    var _this = this;

    return (0, _asyncToGenerator2.default)(function* () {
      let mapping = CHROMEDRIVER_CHROME_MAPPING;

      if (_this.mappingPath) {
        log.debug(`Attempting to use Chromedriver-Chrome mapping from '${_this.mappingPath}'`);

        if (!(yield _appiumSupport.fs.exists(_this.mappingPath))) {
          log.warn(`No file found at '${_this.mappingPath}'. Using default mapping`);
        } else {
          try {
            mapping = JSON.parse((yield _appiumSupport.fs.readFile(_this.mappingPath)));
          } catch (err) {
            log.error(`Error parsing mapping from '${_this.mappingPath}': ${err.message}`);
            log.warn('Using default mapping');
          }
        }
      }

      var _iteratorNormalCompletion = true;
      var _didIteratorError = false;
      var _iteratorError = undefined;

      try {
        for (var _iterator = _lodash.default.toPairs(mapping)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
          const _step$value = (0, _slicedToArray2.default)(_step.value, 2),
                cdVersion = _step$value[0],
                chromeVersion = _step$value[1];

          mapping[cdVersion] = _semver.default.coerce(chromeVersion);
        }
      } catch (err) {
        _didIteratorError = true;
        _iteratorError = err;
      } finally {
        try {
          if (!_iteratorNormalCompletion && _iterator.return != null) {
            _iterator.return();
          }
        } finally {
          if (_didIteratorError) {
            throw _iteratorError;
          }
        }
      }

      return mapping;
    })();
  }

  getChromedrivers(mapping) {
    var _this2 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      const executables = yield _appiumSupport.fs.glob(`${_this2.executableDir}/*`);
      log.debug(`Found ${executables.length} executable${executables.length === 1 ? '' : 's'} ` + `in '${_this2.executableDir}'`);
      const cds = (yield (0, _asyncbox.asyncmap)(executables, function () {
        var _ref = (0, _asyncToGenerator2.default)(function* (executable) {
          const logError = ({
            message,
            stdout = null,
            stderr = null
          }) => {
            let errMsg = `Cannot retrieve version number from '${_path.default.basename(executable)}' Chromedriver binary. ` + `Make sure it returns a valid version string in response to '--version' command line argument. ${message}`;

            if (stdout) {
              errMsg += `\nStdout: ${stdout}`;
            }

            if (stderr) {
              errMsg += `\nStderr: ${stderr}`;
            }

            log.warn(errMsg);
            return null;
          };

          let stdout;
          let stderr;

          try {
            var _ref2 = yield (0, _teen_process.exec)(executable, ['--version']);

            stdout = _ref2.stdout;
            stderr = _ref2.stderr;
          } catch (err) {
            return logError(err);
          }

          const match = /ChromeDriver\s+([\d.]+)/i.exec(stdout);

          if (!match) {
            return logError({
              message: 'Cannot parse the version string',
              stdout,
              stderr
            });
          }

          const versionObj = _semver.default.coerce(match[1], true);

          if (!versionObj) {
            return logError({
              message: 'Cannot coerce the version number',
              stdout,
              stderr
            });
          }

          const version = `${versionObj.major}.${versionObj.minor}`;
          return {
            executable,
            version,
            minCDVersion: mapping[version]
          };
        });

        return function (_x) {
          return _ref.apply(this, arguments);
        };
      }())).filter(cd => !!cd).sort((a, b) => _semver.default.gte(_semver.default.coerce(b.version), _semver.default.coerce(a.version)) ? 1 : -1);

      if (_lodash.default.isEmpty(cds)) {
        log.errorAndThrow(`No Chromedrivers found in '${_this2.executableDir}'`);
      }

      log.debug(`The following Chromedriver executables were found:`);
      var _iteratorNormalCompletion2 = true;
      var _didIteratorError2 = false;
      var _iteratorError2 = undefined;

      try {
        for (var _iterator2 = cds[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
          const cd = _step2.value;
          log.debug(`    ${cd.executable} (minimum Chrome version '${cd.minCDVersion ? cd.minCDVersion : 'Unknown'}')`);
        }
      } catch (err) {
        _didIteratorError2 = true;
        _iteratorError2 = err;
      } finally {
        try {
          if (!_iteratorNormalCompletion2 && _iterator2.return != null) {
            _iterator2.return();
          }
        } finally {
          if (_didIteratorError2) {
            throw _iteratorError2;
          }
        }
      }

      return cds;
    })();
  }

  getChromeVersion() {
    var _this3 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      let chromeVersion;

      if (_this3.adb && (yield _this3.adb.getApiLevel()) >= 24) {
        _this3.bundleId = CHROME_BUNDLE_ID;
      }

      if (!_this3.bundleId) {
        _this3.bundleId = CHROME_BUNDLE_ID;

        for (var _i = 0; _i < WEBVIEW_BUNDLE_IDS.length; _i++) {
          const bundleId = WEBVIEW_BUNDLE_IDS[_i];
          chromeVersion = yield (0, _utils.getChromeVersion)(_this3.adb, bundleId);

          if (chromeVersion) {
            _this3.bundleId = bundleId;
            break;
          }
        }
      }

      if (!chromeVersion) {
        chromeVersion = yield (0, _utils.getChromeVersion)(_this3.adb, _this3.bundleId);
      }

      return chromeVersion ? _semver.default.coerce(chromeVersion) : null;
    })();
  }

  getCompatibleChromedriver() {
    var _this4 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      if (!_this4.adb) {
        return yield (0, _utils.getChromedriverBinaryPath)();
      }

      const mapping = yield _this4.getMapping();
      const cds = yield _this4.getChromedrivers(mapping);
      const chromeVersion = yield _this4.getChromeVersion();

      if (!chromeVersion) {
        let cd = cds[0];
        log.warn(`Unable to discover Chrome version. Using Chromedriver ${cd.version} at '${cd.executable}'`);
        return cd.executable;
      }

      log.debug(`Found Chrome bundle '${_this4.bundleId}' version '${chromeVersion}'`);

      if (_semver.default.gt(chromeVersion, _lodash.default.values(mapping)[0]) && !_lodash.default.isUndefined(cds[0]) && _lodash.default.isUndefined(cds[0].minCDVersion)) {
        let cd = cds[0];
        log.warn(`No known Chromedriver available to automate Chrome version '${chromeVersion}'.\n` + `Using Chromedriver version '${cd.version}', which has not been tested with Appium.`);
        return cd.executable;
      }

      const workingCds = cds.filter(cd => {
        return !_lodash.default.isUndefined(cd.minCDVersion) && _semver.default.gte(chromeVersion, cd.minCDVersion);
      });

      if (_lodash.default.isEmpty(workingCds)) {
        log.errorAndThrow(`No Chromedriver found that can automate Chrome '${chromeVersion}'. ` + `See https://github.com/appium/appium/blob/master/docs/en/writing-running-appium/web/chromedriver.md ` + `for more details.`);
      }

      const binPath = workingCds[0].executable;
      log.debug(`Found ${workingCds.length} Chromedriver executable${workingCds.length === 1 ? '' : 's'} ` + `capable of automating Chrome '${chromeVersion}'.\n` + `Choosing the most recent, '${binPath}'.`);
      log.debug('If a specific version is required, specify it with the `chromedriverExecutable`' + 'desired capability.');
      return binPath;
    })();
  }

  initChromedriverPath() {
    var _this5 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      if (_this5.executableVerified) return;

      if (!_this5.chromedriver) {
        _this5.chromedriver = _this5.useSystemExecutable ? yield (0, _utils.getChromedriverBinaryPath)() : yield _this5.getCompatibleChromedriver();
      }

      if (!(yield _appiumSupport.fs.exists(_this5.chromedriver))) {
        throw new Error(`Trying to use a chromedriver binary at the path ` + `${_this5.chromedriver}, but it doesn't exist!`);
      }

      _this5.executableVerified = true;
      log.info(`Set chromedriver binary as: ${_this5.chromedriver}`);
    })();
  }

  start(caps, emitStartingState = true) {
    var _this6 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      _this6.capabilities = caps;

      if (emitStartingState) {
        _this6.changeState(Chromedriver.STATE_STARTING);
      }

      let args = ["--url-base=wd/hub", `--port=${_this6.proxyPort}`];

      if (_this6.adb && _this6.adb.adbPort) {
        args = args.concat([`--adb-port=${_this6.adb.adbPort}`]);
      }

      if (_this6.cmdArgs) {
        args = args.concat(_this6.cmdArgs);
      }

      if (_this6.logPath) {
        args = args.concat([`--log-path=${_this6.logPath}`]);
      }

      args = args.concat(['--verbose']);

      const startDetector = stdout => {
        return stdout.indexOf('Starting ') === 0;
      };

      let processIsAlive = false;
      let webviewVersion;

      try {
        yield _this6.initChromedriverPath();
        yield _this6.killAll();
        _this6.proc = new _teen_process.SubProcess(_this6.chromedriver, args);
        processIsAlive = true;

        _this6.proc.on('output', (stdout, stderr) => {
          const out = stdout + stderr;
          let match = /"Browser": "(.*)"/.exec(out);

          if (match) {
            webviewVersion = match[1];
            log.debug(`Webview version: '${webviewVersion}'`);
          }

          match = /Starting ChromeDriver ([.\d]+)/.exec(out);

          if (match) {
            log.debug(`Chromedriver version: '${match[1]}'`);
          }

          if (_this6.verbose) {
            var _iteratorNormalCompletion3 = true;
            var _didIteratorError3 = false;
            var _iteratorError3 = undefined;

            try {
              for (var _iterator3 = (stdout || '').trim().split('\n')[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {
                let line = _step3.value;
                if (!line.trim().length) continue;
                log.debug(`[STDOUT] ${line}`);
              }
            } catch (err) {
              _didIteratorError3 = true;
              _iteratorError3 = err;
            } finally {
              try {
                if (!_iteratorNormalCompletion3 && _iterator3.return != null) {
                  _iterator3.return();
                }
              } finally {
                if (_didIteratorError3) {
                  throw _iteratorError3;
                }
              }
            }

            var _iteratorNormalCompletion4 = true;
            var _didIteratorError4 = false;
            var _iteratorError4 = undefined;

            try {
              for (var _iterator4 = (stderr || '').trim().split('\n')[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {
                let line = _step4.value;
                if (!line.trim().length) continue;
                log.error(`[STDERR] ${line}`);
              }
            } catch (err) {
              _didIteratorError4 = true;
              _iteratorError4 = err;
            } finally {
              try {
                if (!_iteratorNormalCompletion4 && _iterator4.return != null) {
                  _iterator4.return();
                }
              } finally {
                if (_didIteratorError4) {
                  throw _iteratorError4;
                }
              }
            }
          }
        });

        _this6.proc.on('exit', (code, signal) => {
          processIsAlive = false;

          if (_this6.state !== Chromedriver.STATE_STOPPED && _this6.state !== Chromedriver.STATE_STOPPING && _this6.state !== Chromedriver.STATE_RESTARTING) {
            let msg = `Chromedriver exited unexpectedly with code ${code}, ` + `signal ${signal}`;
            log.error(msg);

            _this6.changeState(Chromedriver.STATE_STOPPED);
          }
        });

        log.info(`Spawning chromedriver with: ${_this6.chromedriver} ` + `${args.join(' ')}`);
        yield _this6.proc.start(startDetector);
        yield _this6.waitForOnline();
        yield _this6.startSession();
      } catch (e) {
        _this6.emit(Chromedriver.EVENT_ERROR, e);

        if (processIsAlive) {
          yield _this6.proc.stop();
        }

        if (e.message.indexOf('Chrome version must be') !== -1) {
          log.error('Unable to automate Chrome version because it is too old for this version of Chromedriver.');

          if (webviewVersion) {
            log.error(`Chrome version on device: ${webviewVersion}`);
          }

          log.error(`Please see 'https://github.com/appium/appium/blob/master/docs/en/writing-running-appium/web/chromedriver.md'`);
        }

        log.errorAndThrow(e);
      }
    })();
  }

  sessionId() {
    if (this.state !== Chromedriver.STATE_ONLINE) {
      return null;
    }

    return this.jwproxy.sessionId;
  }

  restart() {
    var _this7 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      log.info("Restarting chromedriver");

      if (_this7.state !== Chromedriver.STATE_ONLINE) {
        throw new Error("Can't restart when we're not online");
      }

      _this7.changeState(Chromedriver.STATE_RESTARTING);

      yield _this7.stop(false);
      yield _this7.start(_this7.capabilities, false);
    })();
  }

  waitForOnline() {
    var _this8 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      let chromedriverStopped = false;
      yield (0, _asyncbox.retryInterval)(20, 200, (0, _asyncToGenerator2.default)(function* () {
        if (_this8.state === Chromedriver.STATE_STOPPED) {
          chromedriverStopped = true;
          return;
        }

        yield _this8.getStatus();
      }));

      if (chromedriverStopped) {
        throw new Error('ChromeDriver crashed during startup.');
      }
    })();
  }

  getStatus() {
    var _this9 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      return yield _this9.jwproxy.command('/status', 'GET');
    })();
  }

  startSession() {
    var _this10 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      yield (0, _asyncbox.retryInterval)(4, 200, (0, _asyncToGenerator2.default)(function* () {
        try {
          let res = yield _this10.jwproxy.command('/session', 'POST', {
            desiredCapabilities: _this10.capabilities
          });

          if (res.status) {
            throw new Error(res.value.message);
          }
        } catch (err) {
          log.errorAndThrow(`Failed to start Chromedriver session: ${err.message}`);
        }
      }));

      _this10.changeState(Chromedriver.STATE_ONLINE);
    })();
  }

  stop(emitStates = true) {
    var _this11 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      if (emitStates) {
        _this11.changeState(Chromedriver.STATE_STOPPING);
      }

      try {
        yield _this11.jwproxy.command('', 'DELETE');
        yield _this11.proc.stop('SIGTERM', 20000);

        if (emitStates) {
          _this11.changeState(Chromedriver.STATE_STOPPED);
        }
      } catch (e) {
        log.error(e);
      }
    })();
  }

  changeState(state) {
    this.state = state;
    log.debug(`Changed state to '${state}'`);
    this.emit(Chromedriver.EVENT_CHANGED, {
      state
    });
  }

  sendCommand(url, method, body) {
    var _this12 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      return yield _this12.jwproxy.command(url, method, body);
    })();
  }

  proxyReq(req, res) {
    var _this13 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      return yield _this13.jwproxy.proxyReqRes(req, res);
    })();
  }

  killAll() {
    var _this14 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      let cmd;

      if (_appiumSupport.system.isWindows()) {
        cmd = "FOR /F \"usebackq tokens=5\" %a in (`netstat -nao ^| " + "findstr /R /C:\"" + _this14.proxyPort + " \"`) do (" + "FOR /F \"usebackq\" %b in (`TASKLIST /FI \"PID eq %a\" ^| " + "findstr /I chromedriver.exe`) do (IF NOT %b==\"\" TASKKILL " + "/F /PID %a))";
      } else {
        cmd = `pkill -15 -f "${_this14.chromedriver}.*--port=${_this14.proxyPort}"`;
      }

      log.debug(`Killing any old chromedrivers, running: ${cmd}`);

      try {
        yield _bluebird.default.promisify(_child_process.default.exec)(cmd);
        log.debug("Successfully cleaned up old chromedrivers");
      } catch (err) {
        log.warn("No old chromedrivers seemed to exist");
      }

      if (_this14.adb) {
        log.debug(`Cleaning any old adb forwarded port socket connections`);

        try {
          var _iteratorNormalCompletion5 = true;
          var _didIteratorError5 = false;
          var _iteratorError5 = undefined;

          try {
            for (var _iterator5 = (yield _this14.adb.getForwardList())[Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {
              let conn = _step5.value;

              if (conn.indexOf('webview_devtools') !== -1) {
                let params = conn.split(/\s+/);

                if (params.length > 1) {
                  yield _this14.adb.removePortForward(params[1].replace(/[\D]*/, ''));
                }
              }
            }
          } catch (err) {
            _didIteratorError5 = true;
            _iteratorError5 = err;
          } finally {
            try {
              if (!_iteratorNormalCompletion5 && _iterator5.return != null) {
                _iterator5.return();
              }
            } finally {
              if (_didIteratorError5) {
                throw _iteratorError5;
              }
            }
          }
        } catch (err) {
          log.warn(`Unable to clean forwarded ports. Error: '${err.message}'. Continuing.`);
        }
      }
    })();
  }

  hasWorkingWebview() {
    var _this15 = this;

    return (0, _asyncToGenerator2.default)(function* () {
      try {
        yield _this15.jwproxy.command('/url', 'GET');
        return true;
      } catch (e) {
        return false;
      }
    })();
  }

}

exports.Chromedriver = Chromedriver;
Chromedriver.EVENT_ERROR = 'chromedriver_error';
Chromedriver.EVENT_CHANGED = 'stateChanged';
Chromedriver.STATE_STOPPED = 'stopped';
Chromedriver.STATE_STARTING = 'starting';
Chromedriver.STATE_ONLINE = 'online';
Chromedriver.STATE_STOPPING = 'stopping';
Chromedriver.STATE_RESTARTING = 'restarting';
var _default = Chromedriver;
exports.default = _default;require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9jaHJvbWVkcml2ZXIuanMiXSwibmFtZXMiOlsibG9nIiwibG9nZ2VyIiwiZ2V0TG9nZ2VyIiwiREVGQVVMVF9IT1NUIiwiREVGQVVMVF9QT1JUIiwiQ0hST01FRFJJVkVSX0NIUk9NRV9NQVBQSU5HIiwiQ0hST01FX0JVTkRMRV9JRCIsIldFQlZJRVdfQlVORExFX0lEUyIsIkNEX1ZFUiIsInByb2Nlc3MiLCJlbnYiLCJucG1fY29uZmlnX2Nocm9tZWRyaXZlcl92ZXJzaW9uIiwiQ0hST01FRFJJVkVSX1ZFUlNJT04iLCJnZXRNb3N0UmVjZW50Q2hyb21lZHJpdmVyIiwibWFwcGluZyIsIl8iLCJpc0VtcHR5IiwiRXJyb3IiLCJrZXlzIiwibWFwIiwic2VtdmVyIiwiY29lcmNlIiwic29ydCIsInJjb21wYXJlIiwidiIsIm1ham9yIiwibWlub3IiLCJDaHJvbWVkcml2ZXIiLCJldmVudHMiLCJFdmVudEVtaXR0ZXIiLCJjb25zdHJ1Y3RvciIsImFyZ3MiLCJob3N0IiwicG9ydCIsInVzZVN5c3RlbUV4ZWN1dGFibGUiLCJleGVjdXRhYmxlIiwiZXhlY3V0YWJsZURpciIsImJ1bmRsZUlkIiwibWFwcGluZ1BhdGgiLCJjbWRBcmdzIiwiYWRiIiwidmVyYm9zZSIsImxvZ1BhdGgiLCJwcm94eUhvc3QiLCJwcm94eVBvcnQiLCJwcm9jIiwiY2hyb21lZHJpdmVyIiwiZXhlY3V0YWJsZVZlcmlmaWVkIiwic3RhdGUiLCJTVEFURV9TVE9QUEVEIiwiandwcm94eSIsIkpXUHJveHkiLCJzZXJ2ZXIiLCJnZXRNYXBwaW5nIiwiZGVidWciLCJmcyIsImV4aXN0cyIsIndhcm4iLCJKU09OIiwicGFyc2UiLCJyZWFkRmlsZSIsImVyciIsImVycm9yIiwibWVzc2FnZSIsInRvUGFpcnMiLCJjZFZlcnNpb24iLCJjaHJvbWVWZXJzaW9uIiwiZ2V0Q2hyb21lZHJpdmVycyIsImV4ZWN1dGFibGVzIiwiZ2xvYiIsImxlbmd0aCIsImNkcyIsImxvZ0Vycm9yIiwic3Rkb3V0Iiwic3RkZXJyIiwiZXJyTXNnIiwicGF0aCIsImJhc2VuYW1lIiwibWF0Y2giLCJleGVjIiwidmVyc2lvbk9iaiIsInZlcnNpb24iLCJtaW5DRFZlcnNpb24iLCJmaWx0ZXIiLCJjZCIsImEiLCJiIiwiZ3RlIiwiZXJyb3JBbmRUaHJvdyIsImdldENocm9tZVZlcnNpb24iLCJnZXRBcGlMZXZlbCIsImdldENvbXBhdGlibGVDaHJvbWVkcml2ZXIiLCJndCIsInZhbHVlcyIsImlzVW5kZWZpbmVkIiwid29ya2luZ0NkcyIsImJpblBhdGgiLCJpbml0Q2hyb21lZHJpdmVyUGF0aCIsImluZm8iLCJzdGFydCIsImNhcHMiLCJlbWl0U3RhcnRpbmdTdGF0ZSIsImNhcGFiaWxpdGllcyIsImNoYW5nZVN0YXRlIiwiU1RBVEVfU1RBUlRJTkciLCJhZGJQb3J0IiwiY29uY2F0Iiwic3RhcnREZXRlY3RvciIsImluZGV4T2YiLCJwcm9jZXNzSXNBbGl2ZSIsIndlYnZpZXdWZXJzaW9uIiwia2lsbEFsbCIsIlN1YlByb2Nlc3MiLCJvbiIsIm91dCIsInRyaW0iLCJzcGxpdCIsImxpbmUiLCJjb2RlIiwic2lnbmFsIiwiU1RBVEVfU1RPUFBJTkciLCJTVEFURV9SRVNUQVJUSU5HIiwibXNnIiwiam9pbiIsIndhaXRGb3JPbmxpbmUiLCJzdGFydFNlc3Npb24iLCJlIiwiZW1pdCIsIkVWRU5UX0VSUk9SIiwic3RvcCIsInNlc3Npb25JZCIsIlNUQVRFX09OTElORSIsInJlc3RhcnQiLCJjaHJvbWVkcml2ZXJTdG9wcGVkIiwiZ2V0U3RhdHVzIiwiY29tbWFuZCIsInJlcyIsImRlc2lyZWRDYXBhYmlsaXRpZXMiLCJzdGF0dXMiLCJ2YWx1ZSIsImVtaXRTdGF0ZXMiLCJFVkVOVF9DSEFOR0VEIiwic2VuZENvbW1hbmQiLCJ1cmwiLCJtZXRob2QiLCJib2R5IiwicHJveHlSZXEiLCJyZXEiLCJwcm94eVJlcVJlcyIsImNtZCIsInN5c3RlbSIsImlzV2luZG93cyIsIkIiLCJwcm9taXNpZnkiLCJjcCIsImdldEZvcndhcmRMaXN0IiwiY29ubiIsInBhcmFtcyIsInJlbW92ZVBvcnRGb3J3YXJkIiwicmVwbGFjZSIsImhhc1dvcmtpbmdXZWJ2aWV3Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUVBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUdBLE1BQU1BLEdBQUcsR0FBR0Msc0JBQU9DLFNBQVAsQ0FBaUIsY0FBakIsQ0FBWjs7QUFFQSxNQUFNQyxZQUFZLEdBQUcsV0FBckI7QUFDQSxNQUFNQyxZQUFZLEdBQUcsSUFBckI7QUFDQSxNQUFNQywyQkFBMkIsR0FBRztBQUVsQyxVQUFRLFdBRjBCO0FBR2xDLFVBQVEsV0FIMEI7QUFJbEMsVUFBUSxXQUowQjtBQUtsQyxVQUFRLFdBTDBCO0FBTWxDLFVBQVEsV0FOMEI7QUFPbEMsVUFBUSxXQVAwQjtBQVFsQyxVQUFRLFdBUjBCO0FBU2xDLFVBQVEsV0FUMEI7QUFVbEMsVUFBUSxXQVYwQjtBQVdsQyxVQUFRLFdBWDBCO0FBWWxDLFVBQVEsV0FaMEI7QUFhbEMsVUFBUSxXQWIwQjtBQWNsQyxVQUFRLFdBZDBCO0FBZWxDLFVBQVEsV0FmMEI7QUFnQmxDLFVBQVEsV0FoQjBCO0FBaUJsQyxVQUFRLFdBakIwQjtBQWtCbEMsVUFBUSxXQWxCMEI7QUFtQmxDLFVBQVEsV0FuQjBCO0FBb0JsQyxVQUFRLFdBcEIwQjtBQXFCbEMsVUFBUSxXQXJCMEI7QUFzQmxDLFVBQVEsV0F0QjBCO0FBdUJsQyxVQUFRLFdBdkIwQjtBQXdCbEMsVUFBUSxXQXhCMEI7QUF5QmxDLFVBQVEsV0F6QjBCO0FBMEJsQyxVQUFRLFdBMUIwQjtBQTJCbEMsVUFBUSxXQTNCMEI7QUE0QmxDLFVBQVEsV0E1QjBCO0FBNkJsQyxVQUFRLFdBN0IwQjtBQThCbEMsVUFBUSxXQTlCMEI7QUErQmxDLFVBQVEsV0EvQjBCO0FBZ0NsQyxVQUFRLFdBaEMwQjtBQWlDbEMsVUFBUSxXQWpDMEI7QUFrQ2xDLFVBQVEsV0FsQzBCO0FB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R0FBZ0MsWUFBaEM7ZUFLZTlGLFkiLCJzb3VyY2VzQ29udGVudCI6WyIvLyB0cmFuc3BpbGU6bWFpblxuXG5pbXBvcnQgZXZlbnRzIGZyb20gJ2V2ZW50cyc7XG5pbXBvcnQgeyBKV1Byb3h5IH0gZnJvbSAnYXBwaXVtLWJhc2UtZHJpdmVyJztcbmltcG9ydCBjcCBmcm9tICdjaGlsZF9wcm9jZXNzJztcbmltcG9ydCB7IHN5c3RlbSwgZnMsIGxvZ2dlciB9IGZyb20gJ2FwcGl1bS1zdXBwb3J0JztcbmltcG9ydCB7IHJldHJ5SW50ZXJ2YWwsIGFzeW5jbWFwIH0gZnJvbSAnYXN5bmNib3gnO1xuaW1wb3J0IHsgU3ViUHJvY2VzcywgZXhlYyB9IGZyb20gJ3RlZW5fcHJvY2Vzcyc7XG5pbXBvcnQgQiBmcm9tICdibHVlYmlyZCc7XG5pbXBvcnQgeyBnZXRDaHJvbWVWZXJzaW9uLCBnZXRDaHJvbWVkcml2ZXJEaXIsIGdldENocm9tZWRyaXZlckJpbmFyeVBhdGggfSBmcm9tICcuL3V0aWxzJztcbmltcG9ydCBzZW12ZXIgZnJvbSAnc2VtdmVyJztcbmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcblxuXG5jb25zdCBsb2cgPSBsb2dnZXIuZ2V0TG9nZ2VyKCdDaHJvbWVkcml2ZXInKTtcblxuY29uc3QgREVGQVVMVF9IT1NUID0gJzEyNy4wLjAuMSc7XG5jb25zdCBERUZBVUxUX1BPUlQgPSA5NTE1O1xuY29uc3QgQ0hST01FRFJJVkVSX0NIUk9NRV9NQVBQSU5HID0ge1xuICAvLyBDaHJvbWVkcml2ZXIgdmVyc2lvbjogbWludW11bSBDaHJvbWUgdmVyc2lvblxuICAnMi40Myc6ICc2OS4wLjM0OTcnLFxuICAnMi40Mic6ICc2OC4wLjM0NDAnLFxuICAnMi40MSc6ICc2Ny4wLjMzOTYnLFxuICAnMi40MCc6ICc2Ni4wLjMzNTknLFxuICAnMi4zOSc6ICc2Ni4wLjMzNTknLFxuICAnMi4zOCc6ICc2NS4wLjMzMjUnLFxuICAnMi4zNyc6ICc2NC4wLjMyODInLFxuICAnMi4zNic6ICc2My4wLjMyMzknLFxuICAnMi4zNSc6ICc2Mi4wLjMyMDInLFxuICAnMi4zNCc6ICc2MS4wLjMxNjMnLFxuICAnMi4zMyc6ICc2MC4wLjMxMTInLFxuICAnMi4zMic6ICc1OS4wLjMwNzEnLFxuICAnMi4zMSc6ICc1OC4wLjMwMjknLFxuICAnMi4zMCc6ICc1OC4wLjMwMjknLFxuICAnMi4yOSc6ICc1Ny4wLjI5ODcnLFxuICAnMi4yOCc6ICc1NS4wLjI4ODMnLFxuICAnMi4yNyc6ICc1NC4wLjI4NDAnLFxuICAnMi4yNic6ICc1My4wLjI3ODUnLFxuICAnMi4yNSc6ICc1My4wLjI3ODUnLFxuICAnMi4yNCc6ICc1Mi4wLjI3NDMnLFxuICAnMi4yMyc6ICc1MS4wLjI3MDQnLFxuICAnMi4yMic6ICc0OS4wLjI2MjMnLFxuICAnMi4yMSc6ICc0Ni4wLjI0OTAnLFxuICAnMi4yMCc6ICc0My4wLjIzNTcnLFxuICAnMi4xOSc6ICc0My4wLjIzNTcnLFxuICAnMi4xOCc6ICc0My4wLjIzNTcnLFxuICAnMi4xNyc6ICc0Mi4wLjIzMTEnLFxuICAnMi4xNic6ICc0Mi4wLjIzMTEnLFxuICAnMi4xNSc6ICc0MC4wLjIyMTQnLFxuICAnMi4xNCc6ICczOS4wLjIxNzEnLFxuICAnMi4xMyc6ICczOC4wLjIxMjUnLFxuICAnMi4xMic6ICczNi4wLjE5ODUnLFxuICAnMi4xMSc6ICczNi4wLjE5ODUnLFxuICAnMi4xMCc6ICczMy4wLjE3NTEnLFxuICAnMi45JzogJzMxLjAuMTY1MCcsXG4gICcyLjgnOiAnMzAuMC4xNTczJyxcbiAgJzIuNyc6ICczMC4wLjE1NzMnLFxuICAnMi42JzogJzI5LjAuMTU0NScsXG4gICcyLjUnOiAnMjkuMC4xNTQ1JyxcbiAgJzIuNCc6ICcyOS4wLjE1NDUnLFxuICAnMi4zJzogJzI4LjAuMTUwMCcsXG4gICcyLjInOiAnMjcuMC4xNDUzJyxcbiAgJzIuMSc6ICcyNy4wLjE0NTMnLFxuICAnMi4wJzogJzI3LjAuMTQ1MycsXG59O1xuY29uc3QgQ0hST01FX0JVTkRMRV9JRCA9ICdjb20uYW5kcm9pZC5jaHJvbWUnO1xuY29uc3QgV0VCVklFV19CVU5ETEVfSURTID0gW1xuICAnY29tLmdvb2dsZS5hbmRyb2lkLndlYnZpZXcnLFxuICAnY29tLmFuZHJvaWQud2VidmlldycsXG5dO1xuXG5jb25zdCBDRF9WRVIgPSBwcm9jZXNzLmVudi5ucG1fY29uZmlnX2Nocm9tZWRyaXZlcl92ZXJzaW9uIHx8XG4gICAgICAgICAgICAgICBwcm9jZXNzLmVudi5DSFJPTUVEUklWRVJfVkVSU0lPTiB8fFxuICAgICAgICAgICAgICAgZ2V0TW9zdFJlY2VudENocm9tZWRyaXZlcigpO1xuXG5mdW5jdGlvbiBnZXRNb3N0UmVjZW50Q2hyb21lZHJpdmVyIChtYXBwaW5nID0gQ0hST01FRFJJVkVSX0NIUk9NRV9NQVBQSU5HKSB7XG4gIGlmIChfLmlzRW1wdHkobWFwcGluZykpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuYWJsZSB0byBnZXQgbW9zdCByZWNlbnQgQ2hyb21lZHJpdmVyIGZyb20gZW1wdHkgbWFwcGluZycpO1xuICB9XG4gIHJldHVybiBfLmtleXMobWFwcGluZylcbiAgICAubWFwKHNlbXZlci5jb2VyY2UpXG4gICAgLnNvcnQoc2VtdmVyLnJjb21wYXJlKVxuICAgIC5tYXAoKHYpID0+IGAke3NlbXZlci5tYWpvcih2KX0uJHtzZW12ZXIubWlub3Iodil9YClbMF07XG59XG5cbmNsYXNzIENocm9tZWRyaXZlciBleHRlbmRzIGV2ZW50cy5FdmVudEVtaXR0ZXIge1xuICBjb25zdHJ1Y3RvciAoYXJncyA9IHt9KSB7XG4gICAgc3VwZXIoKTtcblxuICAgIGNvbnN0IHtcbiAgICAgIGhvc3QgPSBERUZBVUxUX0hPU1QsXG4gICAgICBwb3J0ID0gREVGQVVMVF9QT1JULFxuICAgICAgdXNlU3lzdGVtRXhlY3V0YWJsZSA9IGZhbHNlLFxuICAgICAgZXhlY3V0YWJsZSxcbiAgICAgIGV4ZWN1dGFibGVEaXIgPSBnZXRDaHJvbWVkcml2ZXJEaXIoKSxcbiAgICAgIGJ1bmRsZUlkLFxuICAgICAgbWFwcGluZ1BhdGgsXG4gICAgICBjbWRBcmdzLFxuICAgICAgYWRiLFxuICAgICAgdmVyYm9zZSxcbiAgICAgIGxvZ1BhdGgsXG4gICAgfSA9IGFyZ3M7XG5cbiAgICB0aGlzLnByb3h5SG9zdCA9IGhvc3Q7XG4gICAgdGhpcy5wcm94eVBvcnQgPSBwb3J0O1xuICAgIHRoaXMuYWRiID0gYWRiO1xuICAgIHRoaXMuY21kQXJncyA9IGNtZEFyZ3M7XG4gICAgdGhpcy5wcm9jID0gbnVsbDtcbiAgICB0aGlzLnVzZVN5c3RlbUV4ZWN1dGFibGUgPSB1c2VTeXN0ZW1FeGVjdXRhYmxlO1xuICAgIHRoaXMuY2hyb21lZHJpdmVyID0gZXhlY3V0YWJsZTtcbiAgICB0aGlzLmV4ZWN1dGFibGVEaXIgPSBleGVjdXRhYmxlRGlyO1xuICAgIHRoaXMubWFwcGluZ1BhdGggPSBtYXBwaW5nUGF0aDtcbiAgICB0aGlzLmJ1bmRsZUlkID0gYnVuZGxlSWQ7XG4gICAgdGhpcy5leGVjdXRhYmxlVmVyaWZpZWQgPSBmYWxzZTtcbiAgICB0aGlzLnN0YXRlID0gQ2hyb21lZHJpdmVyLlNUQVRFX1NUT1BQRUQ7XG4gICAgdGhpcy5qd3Byb3h5ID0gbmV3IEpXUHJveHkoe3NlcnZlcjogdGhpcy5wcm94eUhvc3QsIHBvcnQ6IHRoaXMucHJveHlQb3J0fSk7XG4gICAgdGhpcy52ZXJib3NlID0gdmVyYm9zZTtcbiAgICB0aGlzLmxvZ1BhdGggPSBsb2dQYXRoO1xuICB9XG5cbiAgYXN5bmMgZ2V0TWFwcGluZyAoKSB7XG4gICAgbGV0IG1hcHBpbmcgPSBDSFJPTUVEUklWRVJfQ0hST01FX01BUFBJTkc7XG4gICAgaWYgKHRoaXMubWFwcGluZ1BhdGgpIHtcbiAgICAgIGxvZy5kZWJ1ZyhgQXR0ZW1wdGluZyB0byB1c2UgQ2hyb21lZHJpdmVyLUNocm9tZSBtYXBwaW5nIGZyb20gJyR7dGhpcy5tYXBwaW5nUGF0aH0nYCk7XG4gICAgICBpZiAoIWF3YWl0IGZzLmV4aXN0cyh0aGlzLm1hcHBpbmdQYXRoKSkge1xuICAgICAgICBsb2cud2FybihgTm8gZmlsZSBmb3VuZCBhdCAnJHt0aGlzLm1hcHBpbmdQYXRofScuIFVzaW5nIGRlZmF1bHQgbWFwcGluZ2ApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBtYXBwaW5nID0gSlNPTi5wYXJzZShhd2FpdCBmcy5yZWFkRmlsZSh0aGlzLm1hcHBpbmdQYXRoKSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgIGxvZy5lcnJvcihgRXJyb3IgcGFyc2luZyBtYXBwaW5nIGZyb20gJyR7dGhpcy5tYXBwaW5nUGF0aH0nOiAke2Vyci5tZXNzYWdlfWApO1xuICAgICAgICAgIGxvZy53YXJuKCdVc2luZyBkZWZhdWx0IG1hcHBpbmcnKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIG1ha2Ugc3VyZSB0aGF0IHRoZSB2YWx1ZXMgZm9yIG1pbmltdW0gY2hyb21lIHZlcnNpb24gYXJlIHNlbXZlciBjb21wbGlhbnRcbiAgICBmb3IgKGNvbnN0IFtjZFZlcnNpb24sIGNocm9tZVZlcnNpb25dIG9mIF8udG9QYWlycyhtYXBwaW5nKSkge1xuICAgICAgbWFwcGluZ1tjZFZlcnNpb25dID0gc2VtdmVyLmNvZXJjZShjaHJvbWVWZXJzaW9uKTtcbiAgICB9XG4gICAgcmV0dXJuIG1hcHBpbmc7XG4gIH1cblxuICBhc3luYyBnZXRDaHJvbWVkcml2ZXJzIChtYXBwaW5nKSB7XG4gICAgLy8gZ28gdGhyb3VnaCB0aGUgdmVyc2lvbnMgYXZhaWxhYmxlXG4gICAgY29uc3QgZXhlY3V0YWJsZXMgPSBhd2FpdCBmcy5nbG9iKGAke3RoaXMuZXhlY3V0YWJsZURpcn0vKmApO1xuICAgIGxvZy5kZWJ1ZyhgRm91bmQgJHtleGVjdXRhYmxlcy5sZW5ndGh9IGV4ZWN1dGFibGUke2V4ZWN1dGFibGVzLmxlbmd0aCA9PT0gMSA/ICcnIDogJ3MnfSBgICtcbiAgICAgIGBpbiAnJHt0aGlzLmV4ZWN1dGFibGVEaXJ9J2ApO1xuICAgIGNvbnN0IGNkcyA9IChhd2FpdCBhc3luY21hcChleGVjdXRhYmxlcywgYXN5bmMgZnVuY3Rpb24gKGV4ZWN1dGFibGUpIHtcbiAgICAgIGNvbnN0IGxvZ0Vycm9yID0gKHttZXNzYWdlLCBzdGRvdXQgPSBudWxsLCBzdGRlcnIgPSBudWxsfSkgPT4ge1xuICAgICAgICBsZXQgZXJyTXNnID0gYENhbm5vdCByZXRyaWV2ZSB2ZXJzaW9uIG51bWJlciBmcm9tICcke3BhdGguYmFzZW5hbWUoZXhlY3V0YWJsZSl9JyBDaHJvbWVkcml2ZXIgYmluYXJ5LiBgICtcbiAgICAgICAgICBgTWFrZSBzdXJlIGl0IHJldHVybnMgYSB2YWxpZCB2ZXJzaW9uIHN0cmluZyBpbiByZXNwb25zZSB0byAnLS12ZXJzaW9uJyBjb21tYW5kIGxpbmUgYXJndW1lbnQuICR7bWVzc2FnZX1gO1xuICAgICAgICBpZiAoc3Rkb3V0KSB7XG4gICAgICAgICAgZXJyTXNnICs9IGBcXG5TdGRvdXQ6ICR7c3Rkb3V0fWA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0ZGVycikge1xuICAgICAgICAgIGVyck1zZyArPSBgXFxuU3RkZXJyOiAke3N0ZGVycn1gO1xuICAgICAgICB9XG4gICAgICAgIGxvZy53YXJuKGVyck1zZyk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfTtcblxuICAgICAgbGV0IHN0ZG91dDtcbiAgICAgIGxldCBzdGRlcnI7XG4gICAgICB0cnkge1xuICAgICAgICAoe3N0ZG91dCwgc3RkZXJyfSA9IGF3YWl0IGV4ZWMoZXhlY3V0YWJsZSwgWyctLXZlcnNpb24nXSkpO1xuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHJldHVybiBsb2dFcnJvcihlcnIpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBtYXRjaCA9IC9DaHJvbWVEcml2ZXJcXHMrKFtcXGQuXSspL2kuZXhlYyhzdGRvdXQpO1xuICAgICAgaWYgKCFtYXRjaCkge1xuICAgICAgICByZXR1cm4gbG9nRXJyb3Ioe21lc3NhZ2U6ICdDYW5ub3QgcGFyc2UgdGhlIHZlcnNpb24gc3RyaW5nJywgc3Rkb3V0LCBzdGRlcnJ9KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHZlcnNpb25PYmogPSBzZW12ZXIuY29lcmNlKG1hdGNoWzFdLCB0cnVlKTtcbiAgICAgIGlmICghdmVyc2lvbk9iaikge1xuICAgICAgICByZXR1cm4gbG9nRXJyb3Ioe21lc3NhZ2U6ICdDYW5ub3QgY29lcmNlIHRoZSB2ZXJzaW9uIG51bWJlcicsIHN0ZG91dCwgc3RkZXJyfSk7XG4gICAgICB9XG4gICAgICBjb25zdCB2ZXJzaW9uID0gYCR7dmVyc2lvbk9iai5tYWpvcn0uJHt2ZXJzaW9uT2JqLm1pbm9yfWA7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBleGVjdXRhYmxlLFxuICAgICAgICB2ZXJzaW9uLFxuICAgICAgICBtaW5DRFZlcnNpb246IG1hcHBpbmdbdmVyc2lvbl0sXG4gICAgICB9O1xuICAgIH0pKVxuICAgICAgLmZpbHRlcigoY2QpID0+ICEhY2QpXG4gICAgICAuc29ydCgoYSwgYikgPT4gc2VtdmVyLmd0ZShzZW12ZXIuY29lcmNlKGIudmVyc2lvbiksIHNlbXZlci5jb2VyY2UoYS52ZXJzaW9uKSkgPyAxIDogLTEpO1xuICAgIGlmIChfLmlzRW1wdHkoY2RzKSkge1xuICAgICAgbG9nLmVycm9yQW5kVGhyb3coYE5vIENocm9tZWRyaXZlcnMgZm91bmQgaW4gJyR7dGhpcy5leGVjdXRhYmxlRGlyfSdgKTtcbiAgICB9XG4gICAgbG9nLmRlYnVnKGBUaGUgZm9sbG93aW5nIENocm9tZWRyaXZlciBleGVjdXRhYmxlcyB3ZXJlIGZvdW5kOmApO1xuICAgIGZvciAoY29uc3QgY2Qgb2YgY2RzKSB7XG4gICAgICBsb2cuZGVidWcoYCAgICAke2NkLmV4ZWN1dGFibGV9IChtaW5pbXVtIENocm9tZSB2ZXJzaW9uICcke2NkLm1pbkNEVmVyc2lvbiA/IGNkLm1pbkNEVmVyc2lvbiA6ICdVbmtub3duJ30nKWApO1xuICAgIH1cbiAgICByZXR1cm4gY2RzO1xuICB9XG5cbiAgYXN5bmMgZ2V0Q2hyb21lVmVyc2lvbiAoKSB7XG4gICAgbGV0IGNocm9tZVZlcnNpb247XG5cbiAgICAvLyBvbiBBbmRyb2lkIDcrIHdlYnZpZXdzIGFyZSBiYWNrZWQgYnkgdGhlIG1haW4gQ2hyb21lLCBub3QgdGhlIHN5c3RlbSB3ZWJ2aWV3XG4gICAgaWYgKHRoaXMuYWRiICYmIGF3YWl0IHRoaXMuYWRiLmdldEFwaUxldmVsKCkgPj0gMjQpIHtcbiAgICAgIHRoaXMuYnVuZGxlSWQgPSBDSFJPTUVfQlVORExFX0lEO1xuICAgIH1cblxuICAgIC8vIHRyeSBvdXQgd2Vidmlld3Mgd2hlbiBubyBidW5kbGUgaWQgaXMgc2VudCBpblxuICAgIGlmICghdGhpcy5idW5kbGVJZCkge1xuICAgICAgLy8gZGVmYXVsdCB0byB0aGUgZ2VuZXJpYyBDaHJvbWUgYnVuZGxlXG4gICAgICB0aGlzLmJ1bmRsZUlkID0gQ0hST01FX0JVTkRMRV9JRDtcblxuICAgICAgLy8gd2UgaGF2ZSBhIHdlYnZpZXcgb2Ygc29tZSBzb3J0LCBzbyB0cnkgdG8gZmluZCB0aGUgYnVuZGxlIHZlcnNpb25cbiAgICAgIGZvciAoY29uc3QgYnVuZGxlSWQgb2YgV0VCVklFV19CVU5ETEVfSURTKSB7XG4gICAgICAgIGNocm9tZVZlcnNpb24gPSBhd2FpdCBnZXRDaHJvbWVWZXJzaW9uKHRoaXMuYWRiLCBidW5kbGVJZCk7XG4gICAgICAgIGlmIChjaHJvbWVWZXJzaW9uKSB7XG4gICAgICAgICAgdGhpcy5idW5kbGVJZCA9IGJ1bmRsZUlkO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gaWYgd2UgZG8gbm90IGhhdmUgYSBjaHJvbWUgdmVyc2lvbiwgaXQgbXVzdCBub3QgYmUgYSB3ZWJ2aWV3XG4gICAgaWYgKCFjaHJvbWVWZXJzaW9uKSB7XG4gICAgICBjaHJvbWVWZXJzaW9uID0gYXdhaXQgZ2V0Q2hyb21lVmVyc2lvbih0aGlzLmFkYiwgdGhpcy5idW5kbGVJZCk7XG4gICAgfVxuXG4gICAgLy8gbWFrZSBzdXJlIGl0IGlzIHNlbXZlciwgc28gbGF0ZXIgY2hlY2tzIHdvbid0IGZhaWxcbiAgICByZXR1cm4gY2hyb21lVmVyc2lvbiA/IHNlbXZlci5jb2VyY2UoY2hyb21lVmVyc2lvbikgOiBudWxsO1xuICB9XG5cbiAgYXN5bmMgZ2V0Q29tcGF0aWJsZUNocm9tZWRyaXZlciAoKSB7XG4gICAgaWYgKCF0aGlzLmFkYikge1xuICAgICAgcmV0dXJuIGF3YWl0IGdldENocm9tZWRyaXZlckJpbmFyeVBhdGgoKTtcbiAgICB9XG5cbiAgICBjb25zdCBtYXBwaW5nID0gYXdhaXQgdGhpcy5nZXRNYXBwaW5nKCk7XG4gICAgY29uc3QgY2RzID0gYXdhaXQgdGhpcy5nZXRDaHJvbWVkcml2ZXJzKG1hcHBpbmcpO1xuXG4gICAgY29uc3QgY2hyb21lVmVyc2lvbiA9IGF3YWl0IHRoaXMuZ2V0Q2hyb21lVmVyc2lvbigpO1xuXG4gICAgaWYgKCFjaHJvbWVWZXJzaW9uKSB7XG4gICAgICAvLyB1bmFibGUgdG8gZ2V0IHRoZSBjaHJvbWUgdmVyc2lvblxuICAgICAgbGV0IGNkID0gY2RzWzBdO1xuICAgICAgbG9nLndhcm4oYFVuYWJsZSB0byBkaXNjb3ZlciBDaHJvbWUgdmVyc2lvbi4gVXNpbmcgQ2hyb21lZHJpdmVyICR7Y2QudmVyc2lvbn0gYXQgJyR7Y2QuZXhlY3V0YWJsZX0nYCk7XG4gICAgICByZXR1cm4gY2QuZXhlY3V0YWJsZTtcbiAgICB9XG5cbiAgICBsb2cuZGVidWcoYEZvdW5kIENocm9tZSBidW5kbGUgJyR7dGhpcy5idW5kbGVJZH0nIHZlcnNpb24gJyR7Y2hyb21lVmVyc2lvbn0nYCk7XG5cbiAgICBpZiAoc2VtdmVyLmd0KGNocm9tZVZlcnNpb24sIF8udmFsdWVzKG1hcHBpbmcpWzBdKSAmJlxuICAgICAgICAhXy5pc1VuZGVmaW5lZChjZHNbMF0pICYmIF8uaXNVbmRlZmluZWQoY2RzWzBdLm1pbkNEVmVyc2lvbikpIHtcbiAgICAgIC8vIHRoaXMgaXMgYSBjaHJvbWUgYWJvdmUgdGhlIGxhdGVzdCB2ZXJzaW9uIHdlIGtub3cgYWJvdXQsXG4gICAgICAvLyBhbmQgd2UgaGF2ZSBhIGNocm9tZWRyaXZlciB0aGF0IGlzIGJleW9uZCB3aGF0IHdlIGtub3csXG4gICAgICAvLyBzbyB1c2UgdGhlIG1vc3QgcmVjZW50IGNocm9tZWRyaXZlciB0aGF0IHdlIGZvdW5kXG4gICAgICBsZXQgY2QgPSBjZHNbMF07XG4gICAgICBsb2cud2FybihgTm8ga25vd24gQ2hyb21lZHJpdmVyIGF2YWlsYWJsZSB0byBhdXRvbWF0ZSBDaHJvbWUgdmVyc2lvbiAnJHtjaHJvbWVWZXJzaW9ufScuXFxuYCArXG4gICAgICAgICAgICAgICBgVXNpbmcgQ2hyb21lZHJpdmVyIHZlcnNpb24gJyR7Y2QudmVyc2lvbn0nLCB3aGljaCBoYXMgbm90IGJlZW4gdGVzdGVkIHdpdGggQXBwaXVtLmApO1xuICAgICAgcmV0dXJuIGNkLmV4ZWN1dGFibGU7XG4gICAgfVxuXG4gICAgY29uc3Qgd29ya2luZ0NkcyA9IGNkcy5maWx0ZXIoKGNkKSA9PiB7XG4gICAgICByZXR1cm4gIV8uaXNVbmRlZmluZWQoY2QubWluQ0RWZXJzaW9uKSAmJiBzZW12ZXIuZ3RlKGNocm9tZVZlcnNpb24sIGNkLm1pbkNEVmVyc2lvbik7XG4gICAgfSk7XG5cbiAgICBpZiAoXy5pc0VtcHR5KHdvcmtpbmdDZHMpKSB7XG4gICAgICBsb2cuZXJyb3JBbmRUaHJvdyhgTm8gQ2hyb21lZHJpdmVyIGZvdW5kIHRoYXQgY2FuIGF1dG9tYXRlIENocm9tZSAnJHtjaHJvbWVWZXJzaW9ufScuIGAgK1xuICAgICAgICAgICAgICAgICAgICAgICAgYFNlZSBodHRwczovL2dpdGh1Yi5jb20vYXBwaXVtL2FwcGl1bS9ibG9iL21hc3Rlci9kb2NzL2VuL3dyaXRpbmctcnVubmluZy1hcHBpdW0vd2ViL2Nocm9tZWRyaXZlci5tZCBgICtcbiAgICAgICAgICAgICAgICAgICAgICAgIGBmb3IgbW9yZSBkZXRhaWxzLmApO1xuICAgIH1cblxuICAgIGNvbnN0IGJpblBhdGggPSB3b3JraW5nQ2RzWzBdLmV4ZWN1dGFibGU7XG4gICAgbG9nLmRlYnVnKGBGb3VuZCAke3dvcmtpbmdDZHMubGVuZ3RofSBDaHJvbWVkcml2ZXIgZXhlY3V0YWJsZSR7d29ya2luZ0Nkcy5sZW5ndGggPT09IDEgPyAnJyA6ICdzJ30gYCArXG4gICAgICAgICAgICAgIGBjYXBhYmxlIG9mIGF1dG9tYXRpbmcgQ2hyb21lICcke2Nocm9tZVZlcnNpb259Jy5cXG5gICtcbiAgICAgICAgICAgICAgYENob29zaW5nIHRoZSBtb3N0IHJlY2VudCwgJyR7YmluUGF0aH0nLmApO1xuICAgIGxvZy5kZWJ1ZygnSWYgYSBzcGVjaWZpYyB2ZXJzaW9uIGlzIHJlcXVpcmVkLCBzcGVjaWZ5IGl0IHdpdGggdGhlIGBjaHJvbWVkcml2ZXJFeGVjdXRhYmxlYCcgK1xuICAgICAgICAgICAgICAnZGVzaXJlZCBjYXBhYmlsaXR5LicpO1xuICAgIHJldHVybiBiaW5QYXRoO1xuICB9XG5cbiAgYXN5bmMgaW5pdENocm9tZWRyaXZlclBhdGggKCkge1xuICAgIGlmICh0aGlzLmV4ZWN1dGFibGVWZXJpZmllZCkgcmV0dXJuOyAvL2VzbGludC1kaXNhYmxlLWxpbmUgY3VybHlcblxuICAgIC8vIHRoZSBleGVjdXRhYmxlIG1pZ2h0IGJlIHNldCAoaWYgcGFzc2VkIGluKVxuICAgIC8vIG9yIHdlIG1pZ2h0IHdhbnQgdG8gdXNlIHRoZSBiYXNpYyBvbmUgaW5zdGFsbGVkIHdpdGggdGhpcyBkcml2ZXJcbiAgICAvLyBvciB3ZSB3YW50IHRvIGZpZ3VyZSBvdXQgdGhlIGJlc3Qgb25lXG4gICAgaWYgKCF0aGlzLmNocm9tZWRyaXZlcikge1xuICAgICAgdGhpcy5jaHJvbWVkcml2ZXIgPSB0aGlzLnVzZVN5c3RlbUV4ZWN1dGFibGVcbiAgICAgICAgPyBhd2FpdCBnZXRDaHJvbWVkcml2ZXJCaW5hcnlQYXRoKClcbiAgICAgICAgOiBhd2FpdCB0aGlzLmdldENvbXBhdGlibGVDaHJvbWVkcml2ZXIoKTtcbiAgICB9XG5cbiAgICBpZiAoIWF3YWl0IGZzLmV4aXN0cyh0aGlzLmNocm9tZWRyaXZlcikpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgVHJ5aW5nIHRvIHVzZSBhIGNocm9tZWRyaXZlciBiaW5hcnkgYXQgdGhlIHBhdGggYCArXG4gICAgICAgICAgICAgICAgICAgICAgYCR7dGhpcy5jaHJvbWVkcml2ZXJ9LCBidXQgaXQgZG9lc24ndCBleGlzdCFgKTtcbiAgICB9XG4gICAgdGhpcy5leGVjdXRhYmxlVmVyaWZpZWQgPSB0cnVlO1xuICAgIGxvZy5pbmZvKGBTZXQgY2hyb21lZHJpdmVyIGJpbmFyeSBhczogJHt0aGlzLmNocm9tZWRyaXZlcn1gKTtcbiAgfVxuXG4gIGFzeW5jIHN0YXJ0IChjYXBzLCBlbWl0U3RhcnRpbmdTdGF0ZSA9IHRydWUpIHtcbiAgICB0aGlzLmNhcGFiaWxpdGllcyA9IGNhcHM7XG4gICAgaWYgKGVtaXRTdGFydGluZ1N0YXRlKSB7XG4gICAgICB0aGlzLmNoYW5nZVN0YXRlKENocm9tZWRyaXZlci5TVEFURV9TVEFSVElORyk7XG4gICAgfVxuXG4gICAgbGV0IGFyZ3MgPSBbXCItLXVybC1iYXNlPXdkL2h1YlwiLCBgLS1wb3J0PSR7dGhpcy5wcm94eVBvcnR9YF07XG4gICAgaWYgKHRoaXMuYWRiICYmIHRoaXMuYWRiLmFkYlBvcnQpIHtcbiAgICAgIGFyZ3MgPSBhcmdzLmNvbmNhdChbYC0tYWRiLXBvcnQ9JHt0aGlzLmFkYi5hZGJQb3J0fWBdKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuY21kQXJncykge1xuICAgICAgYXJncyA9IGFyZ3MuY29uY2F0KHRoaXMuY21kQXJncyk7XG4gICAgfVxuICAgIGlmICh0aGlzLmxvZ1BhdGgpIHtcbiAgICAgIGFyZ3MgPSBhcmdzLmNvbmNhdChbYC0tbG9nLXBhdGg9JHt0aGlzLmxvZ1BhdGh9YF0pO1xuICAgIH1cbiAgICBhcmdzID0gYXJncy5jb25jYXQoWyctLXZlcmJvc2UnXSk7XG4gICAgLy8gd2hhdCBhcmUgdGhlIHByb2Nlc3Mgc3Rkb3V0L3N0ZGVyciBjb25kaXRpb25zIHdoZXJlaW4gd2Uga25vdyB0aGF0XG4gICAgLy8gdGhlIHByb2Nlc3MgaGFzIHN0YXJ0ZWQgdG8gb3VyIHNhdGlzZmFjdGlvbj9cbiAgICBjb25zdCBzdGFydERldGVjdG9yID0gKHN0ZG91dCkgPT4ge1xuICAgICAgcmV0dXJuIHN0ZG91dC5pbmRleE9mKCdTdGFydGluZyAnKSA9PT0gMDtcbiAgICB9O1xuXG4gICAgbGV0IHByb2Nlc3NJc0FsaXZlID0gZmFsc2U7XG4gICAgbGV0IHdlYnZpZXdWZXJzaW9uO1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCB0aGlzLmluaXRDaHJvbWVkcml2ZXJQYXRoKCk7XG4gICAgICBhd2FpdCB0aGlzLmtpbGxBbGwoKTtcblxuICAgICAgLy8gc2V0IHVwIG91ciBzdWJwcm9jZXNzIG9iamVjdFxuICAgICAgdGhpcy5wcm9jID0gbmV3IFN1YlByb2Nlc3ModGhpcy5jaHJvbWVkcml2ZXIsIGFyZ3MpO1xuICAgICAgcHJvY2Vzc0lzQWxpdmUgPSB0cnVlO1xuXG4gICAgICAvLyBoYW5kbGUgbG9nIG91dHB1dFxuICAgICAgdGhpcy5wcm9jLm9uKCdvdXRwdXQnLCAoc3Rkb3V0LCBzdGRlcnIpID0+IHtcbiAgICAgICAgLy8gaWYgdGhlIGNkIG91dHB1dCBpcyBub3QgcHJpbnRlZCwgZmluZCB0aGUgY2hyb21lIHZlcnNpb24gYW5kIHByaW50XG4gICAgICAgIC8vIHdpbGwgZ2V0IGEgcmVzcG9uc2UgbGlrZVxuICAgICAgICAvLyAgIERldlRvb2xzIHJlc3BvbnNlOiB7XG4gICAgICAgIC8vICAgICAgXCJBbmRyb2lkLVBhY2thZ2VcIjogXCJpby5hcHBpdW0uc2FtcGxlYXBwXCIsXG4gICAgICAgIC8vICAgICAgXCJCcm93c2VyXCI6IFwiQ2hyb21lLzU1LjAuMjg4My45MVwiLFxuICAgICAgICAvLyAgICAgIFwiUHJvdG9jb2wtVmVyc2lvblwiOiBcIjEuMlwiLFxuICAgICAgICAvLyAgICAgIFwiVXNlci1BZ2VudFwiOiBcIi4uLlwiLFxuICAgICAgICAvLyAgICAgIFwiV2ViS2l0LVZlcnNpb25cIjogXCI1MzcuMzZcIlxuICAgICAgICAvLyAgIH1cbiAgICAgICAgY29uc3Qgb3V0ID0gc3Rkb3V0ICsgc3RkZXJyO1xuICAgICAgICBsZXQgbWF0Y2ggPSAvXCJCcm93c2VyXCI6IFwiKC4qKVwiLy5leGVjKG91dCk7XG4gICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgIHdlYnZpZXdWZXJzaW9uID0gbWF0Y2hbMV07XG4gICAgICAgICAgbG9nLmRlYnVnKGBXZWJ2aWV3IHZlcnNpb246ICcke3dlYnZpZXdWZXJzaW9ufSdgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGFsc28gcHJpbnQgY2hyb21lZHJpdmVyIHZlcnNpb24gdG8gbG9nc1xuICAgICAgICAvLyB3aWxsIG91dHB1dCBzb21ldGhpbmcgbGlrZVxuICAgICAgICAvLyAgU3RhcnRpbmcgQ2hyb21lRHJpdmVyIDIuMzMuNTA2MTA2ICg4YTA2YzM5YzQ1ODJmYmZiYWI2OTY2ZGJiMWMzOGE5MTczYmZiMWEyKSBvbiBwb3J0IDk1MTVcbiAgICAgICAgbWF0Y2ggPSAvU3RhcnRpbmcgQ2hyb21lRHJpdmVyIChbLlxcZF0rKS8uZXhlYyhvdXQpO1xuICAgICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgICBsb2cuZGVidWcoYENocm9tZWRyaXZlciB2ZXJzaW9uOiAnJHttYXRjaFsxXX0nYCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBnaXZlIHRoZSBvdXRwdXQgaWYgaXQgaXMgcmVxdWVzdGVkXG4gICAgICAgIGlmICh0aGlzLnZlcmJvc2UpIHtcbiAgICAgICAgICBmb3IgKGxldCBsaW5lIG9mIChzdGRvdXQgfHwgJycpLnRyaW0oKS5zcGxpdCgnXFxuJykpIHtcbiAgICAgICAgICAgIGlmICghbGluZS50cmltKCkubGVuZ3RoKSBjb250aW51ZTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBjdXJseVxuICAgICAgICAgICAgbG9nLmRlYnVnKGBbU1RET1VUXSAke2xpbmV9YCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGZvciAobGV0IGxpbmUgb2YgKHN0ZGVyciB8fCAnJykudHJpbSgpLnNwbGl0KCdcXG4nKSkge1xuICAgICAgICAgICAgaWYgKCFsaW5lLnRyaW0oKS5sZW5ndGgpIGNvbnRpbnVlOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIGN1cmx5XG4gICAgICAgICAgICBsb2cuZXJyb3IoYFtTVERFUlJdICR7bGluZX1gKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyBoYW5kbGUgb3V0LW9mLWJvdW5kIGV4aXQgYnkgc2ltcGx5IGVtaXR0aW5nIGEgc3RvcHBlZCBzdGF0ZVxuICAgICAgdGhpcy5wcm9jLm9uKCdleGl0JywgKGNvZGUsIHNpZ25hbCkgPT4ge1xuICAgICAgICBwcm9jZXNzSXNBbGl2ZSA9IGZhbHNlO1xuICAgICAgICBpZiAodGhpcy5zdGF0ZSAhPT0gQ2hyb21lZHJpdmVyLlNUQVRFX1NUT1BQRUQgJiZcbiAgICAgICAgICAgIHRoaXMuc3RhdGUgIT09IENocm9tZWRyaXZlci5TVEFURV9TVE9QUElORyAmJlxuICAgICAgICAgICAgdGhpcy5zdGF0ZSAhPT0gQ2hyb21lZHJpdmVyLlNUQVRFX1JFU1RBUlRJTkcpIHtcbiAgICAgICAgICBsZXQgbXNnID0gYENocm9tZWRyaXZlciBleGl0ZWQgdW5leHBlY3RlZGx5IHdpdGggY29kZSAke2NvZGV9LCBgICtcbiAgICAgICAgICAgICAgICAgICAgYHNpZ25hbCAke3NpZ25hbH1gO1xuICAgICAgICAgIGxvZy5lcnJvcihtc2cpO1xuICAgICAgICAgIHRoaXMuY2hhbmdlU3RhdGUoQ2hyb21lZHJpdmVyLlNUQVRFX1NUT1BQRUQpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGxvZy5pbmZvKGBTcGF3bmluZyBjaHJvbWVkcml2ZXIgd2l0aDogJHt0aGlzLmNocm9tZWRyaXZlcn0gYCArXG4gICAgICAgICAgICAgICBgJHthcmdzLmpvaW4oJyAnKX1gKTtcbiAgICAgIC8vIHN0YXJ0IHN1YnByb2MgYW5kIHdhaXQgZm9yIHN0YXJ0RGV0ZWN0b3JcbiAgICAgIGF3YWl0IHRoaXMucHJvYy5zdGFydChzdGFydERldGVjdG9yKTtcbiAgICAgIGF3YWl0IHRoaXMud2FpdEZvck9ubGluZSgpO1xuICAgICAgYXdhaXQgdGhpcy5zdGFydFNlc3Npb24oKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICB0aGlzLmVtaXQoQ2hyb21lZHJpdmVyLkVWRU5UX0VSUk9SLCBlKTtcbiAgICAgIC8vIGp1c3QgYmVjYXVzZSB3ZSBoYWQgYW4gZXJyb3IgZG9lc24ndCBtZWFuIHRoZSBjaHJvbWVkcml2ZXIgcHJvY2Vzc1xuICAgICAgLy8gZmluaXNoZWQ7IHdlIHNob3VsZCBjbGVhbiB1cCBpZiBuZWNlc3NhcnlcbiAgICAgIGlmIChwcm9jZXNzSXNBbGl2ZSkge1xuICAgICAgICBhd2FpdCB0aGlzLnByb2Muc3RvcCgpO1xuICAgICAgfVxuXG4gICAgICAvLyBvZnRlbiB0aGUgdXNlcidzIENocm9tZSB2ZXJzaW9uIGlzIHRvbyBsb3cgZm9yIHRoZSB2ZXJzaW9uIG9mIENocm9tZWRyaXZlclxuICAgICAgaWYgKGUubWVzc2FnZS5pbmRleE9mKCdDaHJvbWUgdmVyc2lvbiBtdXN0IGJlJykgIT09IC0xKSB7XG4gICAgICAgIGxvZy5lcnJvcignVW5hYmxlIHRvIGF1dG9tYXRlIENocm9tZSB2ZXJzaW9uIGJlY2F1c2UgaXQgaXMgdG9vIG9sZCBmb3IgdGhpcyB2ZXJzaW9uIG9mIENocm9tZWRyaXZlci4nKTtcbiAgICAgICAgaWYgKHdlYnZpZXdWZXJzaW9uKSB7XG4gICAgICAgICAgbG9nLmVycm9yKGBDaHJvbWUgdmVyc2lvbiBvbiBkZXZpY2U6ICR7d2Vidmlld1ZlcnNpb259YCk7XG4gICAgICAgIH1cbiAgICAgICAgbG9nLmVycm9yKGBQbGVhc2Ugc2VlICdodHRwczovL2dpdGh1Yi5jb20vYXBwaXVtL2FwcGl1bS9ibG9iL21hc3Rlci9kb2NzL2VuL3dyaXRpbmctcnVubmluZy1hcHBpdW0vd2ViL2Nocm9tZWRyaXZlci5tZCdgKTtcbiAgICAgIH1cbiAgICAgIGxvZy5lcnJvckFuZFRocm93KGUpO1xuICAgIH1cbiAgfVxuXG4gIHNlc3Npb25JZCAoKSB7XG4gICAgaWYgKHRoaXMuc3RhdGUgIT09IENocm9tZWRyaXZlci5TVEFURV9PTkxJTkUpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmp3cHJveHkuc2Vzc2lvbklkO1xuICB9XG5cbiAgYXN5bmMgcmVzdGFydCAoKSB7XG4gICAgbG9nLmluZm8oXCJSZXN0YXJ0aW5nIGNocm9tZWRyaXZlclwiKTtcbiAgICBpZiAodGhpcy5zdGF0ZSAhPT0gQ2hyb21lZHJpdmVyLlNUQVRFX09OTElORSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2FuJ3QgcmVzdGFydCB3aGVuIHdlJ3JlIG5vdCBvbmxpbmVcIik7XG4gICAgfVxuICAgIHRoaXMuY2hhbmdlU3RhdGUoQ2hyb21lZHJpdmVyLlNUQVRFX1JFU1RBUlRJTkcpO1xuICAgIGF3YWl0IHRoaXMuc3RvcChmYWxzZSk7XG4gICAgYXdhaXQgdGhpcy5zdGFydCh0aGlzLmNhcGFiaWxpdGllcywgZmFsc2UpO1xuICB9XG5cbiAgYXN5bmMgd2FpdEZvck9ubGluZSAoKSB7XG4gICAgLy8gd2UgbmVlZCB0byBtYWtlIHN1cmUgdGhhdCBDRCBoYXNuJ3QgY3Jhc2hlZFxuICAgIGxldCBjaHJvbWVkcml2ZXJTdG9wcGVkID0gZmFsc2U7XG4gICAgYXdhaXQgcmV0cnlJbnRlcnZhbCgyMCwgMjAwLCBhc3luYyAoKSA9PiB7XG4gICAgICBpZiAodGhpcy5zdGF0ZSA9PT0gQ2hyb21lZHJpdmVyLlNUQVRFX1NUT1BQRUQpIHtcbiAgICAgICAgLy8gd2UgYXJlIGVpdGhlciBzdG9wcGVkIG9yIHN0b3BwaW5nLCBzbyBzb21ldGhpbmcgd2VudCB3cm9uZ1xuICAgICAgICBjaHJvbWVkcml2ZXJTdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgYXdhaXQgdGhpcy5nZXRTdGF0dXMoKTtcbiAgICB9KTtcbiAgICBpZiAoY2hyb21lZHJpdmVyU3RvcHBlZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdDaHJvbWVEcml2ZXIgY3Jhc2hlZCBkdXJpbmcgc3RhcnR1cC4nKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBnZXRTdGF0dXMgKCkge1xuICAgIHJldHVybiBhd2FpdCB0aGlzLmp3cHJveHkuY29tbWFuZCgnL3N0YXR1cycsICdHRVQnKTtcbiAgfVxuXG4gIGFzeW5jIHN0YXJ0U2Vzc2lvbiAoKSB7XG4gICAgLy8gcmV0cnkgc2Vzc2lvbiBzdGFydCA0IHRpbWVzLCBzb21ldGltZXMgdGhpcyBmYWlscyBkdWUgdG8gYWRiXG4gICAgYXdhaXQgcmV0cnlJbnRlcnZhbCg0LCAyMDAsIGFzeW5jICgpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGxldCByZXMgPSBhd2FpdCB0aGlzLmp3cHJveHkuY29tbWFuZCgnL3Nlc3Npb24nLCAnUE9TVCcsIHtkZXNpcmVkQ2FwYWJpbGl0aWVzOiB0aGlzLmNhcGFiaWxpdGllc30pO1xuICAgICAgICAvLyBDaHJvbWVEcml2ZXIgY2FuIHJldHVybiBhIHBvc2l0aXZlIHN0YXR1cyBkZXNwaXRlIGZhaWxpbmdcbiAgICAgICAgaWYgKHJlcy5zdGF0dXMpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IocmVzLnZhbHVlLm1lc3NhZ2UpO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgbG9nLmVycm9yQW5kVGhyb3coYEZhaWxlZCB0byBzdGFydCBDaHJvbWVkcml2ZXIgc2Vzc2lvbjogJHtlcnIubWVzc2FnZX1gKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICB0aGlzLmNoYW5nZVN0YXRlKENocm9tZWRyaXZlci5TVEFURV9PTkxJTkUpO1xuICB9XG5cbiAgYXN5bmMgc3RvcCAoZW1pdFN0YXRlcyA9IHRydWUpIHtcbiAgICBpZiAoZW1pdFN0YXRlcykge1xuICAgICAgdGhpcy5jaGFuZ2VTdGF0ZShDaHJvbWVkcml2ZXIuU1RBVEVfU1RPUFBJTkcpO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgYXdhaXQgdGhpcy5qd3Byb3h5LmNvbW1hbmQoJycsICdERUxFVEUnKTtcbiAgICAgIGF3YWl0IHRoaXMucHJvYy5zdG9wKCdTSUdURVJNJywgMjAwMDApO1xuICAgICAgaWYgKGVtaXRTdGF0ZXMpIHtcbiAgICAgICAgdGhpcy5jaGFuZ2VTdGF0ZShDaHJvbWVkcml2ZXIuU1RBVEVfU1RPUFBFRCk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgbG9nLmVycm9yKGUpO1xuICAgIH1cbiAgfVxuXG4gIGNoYW5nZVN0YXRlIChzdGF0ZSkge1xuICAgIHRoaXMuc3RhdGUgPSBzdGF0ZTtcbiAgICBsb2cuZGVidWcoYENoYW5nZWQgc3RhdGUgdG8gJyR7c3RhdGV9J2ApO1xuICAgIHRoaXMuZW1pdChDaHJvbWVkcml2ZXIuRVZFTlRfQ0hBTkdFRCwge3N0YXRlfSk7XG4gIH1cblxuICBhc3luYyBzZW5kQ29tbWFuZCAodXJsLCBtZXRob2QsIGJvZHkpIHtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5qd3Byb3h5LmNvbW1hbmQodXJsLCBtZXRob2QsIGJvZHkpO1xuICB9XG5cbiAgYXN5bmMgcHJveHlSZXEgKHJlcSwgcmVzKSB7XG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuandwcm94eS5wcm94eVJlcVJlcyhyZXEsIHJlcyk7XG4gIH1cblxuICBhc3luYyBraWxsQWxsICgpIHtcbiAgICBsZXQgY21kO1xuICAgIGlmIChzeXN0ZW0uaXNXaW5kb3dzKCkpIHtcbiAgICAgIC8vIGpzIGhpbnQgY2Fubm90IGhhbmRsZSBiYWNrdGlja3MsIGV2ZW4gZXNjYXBlZCwgd2l0aGluIHRlbXBsYXRlIGxpdGVyYWxzXG4gICAgICBjbWQgPSBcIkZPUiAvRiBcXFwidXNlYmFja3EgdG9rZW5zPTVcXFwiICVhIGluIChgbmV0c3RhdCAtbmFvIF58IFwiICtcbiAgICAgICAgICAgIFwiZmluZHN0ciAvUiAvQzpcXFwiXCIgKyB0aGlzLnByb3h5UG9ydCArIFwiIFxcXCJgKSBkbyAoXCIgK1xuICAgICAgICAgICAgXCJGT1IgL0YgXFxcInVzZWJhY2txXFxcIiAlYiBpbiAoYFRBU0tMSVNUIC9GSSBcXFwiUElEIGVxICVhXFxcIiBefCBcIiArXG4gICAgICAgICAgICBcImZpbmRzdHIgL0kgY2hyb21lZHJpdmVyLmV4ZWApIGRvIChJRiBOT1QgJWI9PVxcXCJcXFwiIFRBU0tLSUxMIFwiICtcbiAgICAgICAgICAgIFwiL0YgL1BJRCAlYSkpXCI7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNtZCA9IGBwa2lsbCAtMTUgLWYgXCIke3RoaXMuY2hyb21lZHJpdmVyfS4qLS1wb3J0PSR7dGhpcy5wcm94eVBvcnR9XCJgO1xuICAgIH1cbiAgICBsb2cuZGVidWcoYEtpbGxpbmcgYW55IG9sZCBjaHJvbWVkcml2ZXJzLCBydW5uaW5nOiAke2NtZH1gKTtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgKEIucHJvbWlzaWZ5KGNwLmV4ZWMpKShjbWQpO1xuICAgICAgbG9nLmRlYnVnKFwiU3VjY2Vzc2Z1bGx5IGNsZWFuZWQgdXAgb2xkIGNocm9tZWRyaXZlcnNcIik7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBsb2cud2FybihcIk5vIG9sZCBjaHJvbWVkcml2ZXJzIHNlZW1lZCB0byBleGlzdFwiKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5hZGIpIHtcbiAgICAgIGxvZy5kZWJ1ZyhgQ2xlYW5pbmcgYW55IG9sZCBhZGIgZm9yd2FyZGVkIHBvcnQgc29ja2V0IGNvbm5lY3Rpb25zYCk7XG4gICAgICB0cnkge1xuICAgICAgICBmb3IgKGxldCBjb25uIG9mIGF3YWl0IHRoaXMuYWRiLmdldEZvcndhcmRMaXN0KCkpIHtcbiAgICAgICAgICAvLyBjaHJvbWVkcml2ZXIgd2lsbCBhc2sgQURCIHRvIGZvcndhcmQgYSBwb3J0IGxpa2UgXCJkZXZpY2VJZCB0Y3A6cG9ydCBsb2NhbGFic3RyYWN0OndlYnZpZXdfZGV2dG9vbHNfcmVtb3RlX3BvcnRcIlxuICAgICAgICAgIGlmIChjb25uLmluZGV4T2YoJ3dlYnZpZXdfZGV2dG9vbHMnKSAhPT0gLTEpIHtcbiAgICAgICAgICAgIGxldCBwYXJhbXMgPSBjb25uLnNwbGl0KC9cXHMrLyk7XG4gICAgICAgICAgICBpZiAocGFyYW1zLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgYXdhaXQgdGhpcy5hZGIucmVtb3ZlUG9ydEZvcndhcmQocGFyYW1zWzFdLnJlcGxhY2UoL1tcXERdKi8sICcnKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgbG9nLndhcm4oYFVuYWJsZSB0byBjbGVhbiBmb3J3YXJkZWQgcG9ydHMuIEVycm9yOiAnJHtlcnIubWVzc2FnZX0nLiBDb250aW51aW5nLmApO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGhhc1dvcmtpbmdXZWJ2aWV3ICgpIHtcbiAgICAvLyBzb21ldGltZXMgY2hyb21lZHJpdmVyIHN0b3BzIGF1dG9tYXRpbmcgd2Vidmlld3MuIHRoaXMgbWV0aG9kIHJ1bnMgYVxuICAgIC8vIHNpbXBsZSBjb21tYW5kIHRvIGRldGVybWluZSBvdXIgc3RhdGUsIGFuZCByZXNwb25kcyBhY2NvcmRpbmdseVxuICAgIHRyeSB7XG4gICAgICBhd2FpdCB0aGlzLmp3cHJveHkuY29tbWFuZCgnL3VybCcsICdHRVQnKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbn1cblxuQ2hyb21lZHJpdmVyLkVWRU5UX0VSUk9SID0gJ2Nocm9tZWRyaXZlcl9lcnJvcic7XG5DaHJvbWVkcml2ZXIuRVZFTlRfQ0hBTkdFRCA9ICdzdGF0ZUNoYW5nZWQnO1xuQ2hyb21lZHJpdmVyLlNUQVRFX1NUT1BQRUQgPSAnc3RvcHBlZCc7XG5DaHJvbWVkcml2ZXIuU1RBVEVfU1RBUlRJTkcgPSAnc3RhcnRpbmcnO1xuQ2hyb21lZHJpdmVyLlNUQVRFX09OTElORSA9ICdvbmxpbmUnO1xuQ2hyb21lZHJpdmVyLlNUQVRFX1NUT1BQSU5HID0gJ3N0b3BwaW5nJztcbkNocm9tZWRyaXZlci5TVEFURV9SRVNUQVJUSU5HID0gJ3Jlc3RhcnRpbmcnO1xuXG5leHBvcnQge1xuICBDaHJvbWVkcml2ZXIsIENIUk9NRURSSVZFUl9DSFJPTUVfTUFQUElORywgZ2V0TW9zdFJlY2VudENocm9tZWRyaXZlciwgQ0RfVkVSLFxufTtcbmV4cG9ydCBkZWZhdWx0IENocm9tZWRyaXZlcjtcbiJdLCJmaWxlIjoibGliL2Nocm9tZWRyaXZlci5qcyIsInNvdXJjZVJvb3QiOiIuLi8uLiJ9
